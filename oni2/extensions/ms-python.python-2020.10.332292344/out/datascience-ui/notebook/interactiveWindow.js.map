{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/datascience-ui/history-react/interactivePanel.less","webpack:///./src/datascience-ui/interactive-common/collapseButton.tsx","webpack:///./src/datascience-ui/interactive-common/inputHistory.ts","webpack:///./src/datascience-ui/history-react/redux/actions.ts","webpack:///./src/datascience-ui/history-react/interactiveCell.tsx","webpack:///./src/datascience-ui/history-react/interactivePanel.tsx","webpack:///./src/datascience-ui/history-react/redux/reducers/creation.ts","webpack:///./src/datascience-ui/history-react/redux/reducers/effects.ts","webpack:///./src/datascience-ui/history-react/redux/reducers/execution.ts","webpack:///./src/datascience-ui/history-react/redux/reducers/index.ts","webpack:///./src/datascience-ui/history-react/index.tsx","webpack:///./src/datascience-ui/history-react/redux/store.ts","webpack:///./src/datascience-ui/history-react/interactivePanel.less?2b98","webpack:///external \"log4js\""],"names":["i","chunkIds","length","deferredModules","j","deferredModule","module","chunkId","type","target","script","enumerable","get","getter","value","key","bind","Object","prototype","hasOwnProperty","call","object","property","console","error","err","jsonpArray","webpackJsonpCallback","exports","push","props","render","collapseInputPolygonClassNames","this","open","theme","collapseInputClassNames","visible","tooltip","ariaExpanded","className","title","onClick","version","baseProfile","width","height","points","fill","label","historyStack","completeUp","code","undefined","up","result","adjustCursors","completeDown","down","add","typed","last","reset","currentPos","createIncomingActionWithPayload","data","payload","messageDirection","createIncomingAction","actionCreators","focusInput","FOCUS_INPUT","restartKernel","RESTART_KERNEL","interruptKernel","INTERRUPT_KERNEL","deleteAllCells","DeleteAllCells","deleteCell","cellId","DELETE_CELL","undo","Undo","redo","Redo","linkClick","href","LINK_CLICK","showPlot","imageHtml","ShowPlot","toggleInputBlock","TOGGLE_INPUT_BLOCK","gotoCell","GOTO_CELL","copyCellCode","COPY_CELL_CODE","gatherCell","GATHER_CELL","gatherCellToScript","GATHER_CELL_TO_SCRIPT","clickCell","CLICK_CELL","editCell","e","EDIT_CELL","versionId","modelId","model","id","forward","reverse","getValue","submitInput","SUBMIT_INPUT","toggleVariableExplorer","TOGGLE_VARIABLE_EXPLORER","setVariableExplorerHeight","containerHeight","gridHeight","SET_VARIABLE_EXPLORER_HEIGHT","expandAll","ExpandAll","collapseAll","CollapseAll","export","EXPORT","exportAs","EXPORT_NOTEBOOK_AS","showDataViewer","variable","columnSize","SHOW_DATA_VIEWER","editorLoaded","EDITOR_LOADED","scroll","isAtBottom","SCROLL","unfocus","UNFOCUS_CELL","codeCreated","CODE_CREATED","editorUnmounted","UNMOUNT","selectKernel","SelectKernel","selectServer","SELECT_SERVER","openSettings","setting","OPEN_SETTINGS","getVariableData","newExecutionCount","refreshCount","startIndex","pageSize","GET_VARIABLE_DATA","executionCount","sortColumn","sortAscending","widgetFailed","ex","IPYWIDGET_RENDER_FAILURE","prop","codeRef","wrapperRef","getCell","cellVM","cell","isCodeCell","cell_type","renderNormalToolbar","hasNoSource","file","EmptyFileName","baseTheme","hidden","state","executing","settings","gatherIsInstalled","disabled","gathering","class","image","Sync","GatherCode","GoToSourceCode","Copy","Cancel","onMouseClick","ev","stopPropagation","renderControls","busy","init","collapseVisible","inputBlockCollapseNeeded","inputBlockShow","editable","execution_count","toString","isEditOnlyCell","EditCellId","toolbar","isBusy","count","editExecutionCount","inputBlockOpen","renderInput","editorOptions","history","inputHistory","codeTheme","onCodeChange","onCodeCreated","unfocused","onUnfocused","testMode","showWatermark","ref","monacoTheme","openLink","editorMeasureClassName","keyDown","isEditCell","onEditCellKeyDown","showLineNumbers","font","disableUndoStack","codeVersion","focusPending","language","isNotebookTrusted","_code","_file","hasOutput","finished","getCodeCell","onKeyDown","event","shiftKey","ctrlKey","metaKey","altKey","preventDefault","onKeyUp","onEditCellKeyUp","_cellId","editCellSubmit","editorInfo","isSuggesting","clear","editCellShiftEscape","focusedElement","document","activeElement","nextTabStop","findTabStop","focus","uri","showingMarkdownEditor","messages","renderNormalCell","componentDidUpdate","prevProps","selected","focused","giveFocus","scrollCount","scrollAndFlash","shouldComponentUpdate","nextProps","current","scrollIntoView","behavior","block","inline","classList","setTimeout","remove","contains","shouldRender","showCellInputCode","directInput","shouldRenderResults","cellOuterClass","cellWrapperClass","themeMatplotlibPlots","role","tabIndex","expandImage","maxTextSize","enableScroll","outputs","hideOutput","contents","endPos","content","slice","isDirty","direction","element","allFocusable","querySelectorAll","tabable","Array","filter","self","indexOf","InteractiveCellComponent","mapStateToProps","main","variableState","variables","mainPanelRef","mainPanelToolbarRef","contentPanelRef","renderCount","internalScrollCount","footerPanelClick","_event","getInputExecutionCount","currentExecutionCount","getContentProps","cellVMs","submittedText","skipNextScroll","renderCell","scrollToBottom","scrollDiv","scrollBeyondLastLine","extraSettings","editor","getVariableProps","toolbarHeight","offsetHeight","debugging","showDataExplorer","skipDefault","closeVariableExplorer","pageIn","pageInVariableData","fontSize","size","supportsDebugging","variableOptions","enableDuringDebugger","_index","containerRef","options","hover","enabled","autoFocus","kernel","div","handleScroll","alwaysScrollOnNewCell","computeIsAtBottom","currentTarget","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","dynamicFont","fontFamily","family","progressBar","loaded","style","rootCss","buildSettingsCss","renderToolbarPanel","renderVariablePanel","onScroll","renderContentPanel","renderFooterPanel","variableExplorerTooltip","redoStack","undoStack","Restart","Interrupt","VariableExplorer","SaveAs","ExportToPython","renderKernelSelection","serverName","shouldShowTrustMessage","variableProps","monacoReady","contentProps","editCellVM","allowInput","editPanelClass","colorizeInputBox","hasFocus","Creation","isCellSupported","alterCellVM","expanded","newCellVM","newText","text","extractInputBlockText","includes","inputBlockText","split","concat","prepareCellVM","mainState","collapseCellInputCodeByDefault","hasBeenRun","startCell","arg","prevState","updateOrAdd","UpdateModel","source","kind","oldDirty","dirty","newDirty","fullText","currentText","updateCell","finishCell","pushStack","index","findIndex","c","newVMs","_c","unmount","LoadAllCellsComplete","cells","Effects","map","oldVM","updateSettings","newSettings","JSON","parse","newEditorOptions","newFontFamily","newFontSize","vscodeThemeName","knownDark","computeKnownDark","GetCssRequest","isDark","GetMonacoThemeRequest","scrollToCell","scrolled","unfocusCell","Execution","cloneDeep","startDebugging","stopDebugging","matcher","stripFirstMarker","newCell","splitLines","trim","firstLine","isMarkdown","collapseInputs","useQuickEdit","SubmitNewCell","reducerMap","selectJupyterURI","exportCells","showExportAsMenu","SAVE","save","gather","gatherToScript","started","LoadAllCells","LOAD_IPYWIDGET_CLASS_SUCCESS","handleLoadIPyWidgetClassSuccess","LOAD_IPYWIDGET_CLASS_FAILURE","handleLoadIPyWidgetClassFailure","IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED","notifyAboutUnsupportedWidgetVersions","handleIPyWidgetRenderFailure","StartCell","FinishCell","UpdateCellWithExecutionResults","Activate","activate","RestartKernel","handleRestarted","GetCssResponse","handleCss","MonacoReady","GetMonacoThemeResponse","monacoThemeChange","GetAllCells","getAllCells","StartProgress","startProgress","StopProgress","stopProgress","UpdateSettings","StartDebugging","StopDebugging","ScrollToCell","UpdateKernel","updateStatus","LocInit","handleLocInit","UpdateDisplayData","handleUpdateDisplayData","HasCell","hasCell","Gathering","postOffice","window","inTestMode","acquireVsCodeApi","ConnectedInteractiveEditor","store","widgetContainerId","getElementById","transform","locals","log4js"],"mappings":"aACA,cAQA,IAPA,IAMA,IANA,OACA,OACA,OAIA,SACQA,EAAIC,EAASC,OAAQF,IAC7B,OACA,MACA,gBAEA,OAEA,WACA,4CACA,WAKA,IAFA,QAEA,UACA,YAOA,OAHA,sBAGA,IAEA,aAEA,IADA,MACA,IAAkBA,EAAIG,EAAgBD,OAAQF,IAAK,CAGnD,IAFA,WACA,KACA,IAAmBI,EAAIC,EAAeH,OAAQE,IAAK,CACnD,WACA,iBAEA,IACA,gBACA,eAIA,SAIA,SAKA,GACA,qBAGA,KAQA,cAGA,QACA,oBAGA,YACA,IACA,KACA,YA2BA,OAvBA,mCAGA,OAGA,YACA,eACA,2BACA,sBACA,CACA,sBACA,0BACA,iCACA,mBACA,4BACA,4BAEA,OAEA,6BAdA,CAgBME,GACN,UAKA,gBACA,SAKA,OACA,SAGA,KACA,iBACW,CAEX,iCACA,gBAEA,eAGA,IACA,EADA,mCAGA,kBACA,cACA,MACA,6BAEA,MA3EA,YACA,gBAAyC,sFAAsF,sFAAsF,WAAa,aAAa,yBAA2B,2BAA2B,4BAA4B,4BAA4B,uBAAuB,uBAAuB,kBAAkB,kBAAkB,6BAA6B,6BAA6B,eAAe,eAAe,KAAO,OAAO,iBAAiB,kBAAkBC,IAAUA,GAAW,aA0E7kB,IAGA,gBACA,cAEA,wBACA,gBACA,WACA,UACA,MACA,4CACA,4BACA,wDACA,wBACA,SACA,YACA,QAEA,cAGA,6BACA,GAAyBC,KAAM,UAAWC,OAAQC,MAC1C,MACR,qBACA,6BAGA,uBAIA,MAGA,MAGA,oBACA,UACA,2BAA2CC,YAAY,EAAMC,IAAKC,KAKlE,gBACA,gDACA,4CAAyDC,MAAO,WAEhE,sCAAkDA,OAAO,KAQzD,kBAEA,GADA,cACA,aACA,qDACA,0BAGA,GAFA,OACA,mCAA0CH,YAAY,EAAMG,MAAOA,IACnE,2DAAiH,OAAOA,EAAMC,IAAQC,KAAK,KAAMD,IACjJ,UAIA,gBACA,sBACA,WAA4B,OAAOT,EAAgB,SACnD,WAAkC,OAAOA,GAEzC,OADA,aACA,GAIA,kBAAuD,OAAOW,OAAOC,UAAUC,eAAeC,KAAKC,EAAQC,IAG3G,OAGA,iBAA+D,MAApBC,QAAQC,MAAMC,GAAYA,GAErE,kDACA,iBACA,SACA,YACA,YAAiBzB,EAAI0B,EAAWxB,OAAQF,IAAK2B,EAAqBD,EAAW1B,IAC7E,QAIA,+BAEA,I,0BC7OA4B,EAAUtB,EAAOsB,QAAU,EAAQ,OAAR,EAA4D,IAE/E5B,EAAE,EAAQ,QAAiF,IAGnG4B,EAAQC,KAAK,CAACvB,EAAON,EAAI,msCAAosC,M,sYCW7tC,cACI,WAAY8B,G,OACR,YAAMA,IAAM,KA4BpB,OA9BoC,iBAKzB,YAAAC,OAAP,WACI,IAAMC,EAAiC,uBACnCC,KAAKH,MAAMI,KAAO,6BAA+B,IAAE,uBAChCD,KAAKH,MAAMK,MAC5BC,EAA0B,gCAA+BH,KAAKH,MAAMO,QAAU,GAAK,cACnFC,EAAUL,KAAKH,MAAMI,KACrB,YAAa,6BAA8B,YAC3C,YAAa,2BAA4B,UACzCK,EAAeN,KAAKH,MAAMI,KAAO,OAAS,QAGhD,OACI,0BACIM,UAAWJ,EACXK,MAAOH,EACPI,QAAST,KAAKH,MAAMY,QAAO,gBACZH,GAEf,uBAAKI,QAAQ,MAAMC,YAAY,OAAOC,MAAM,MAAMC,OAAO,QACrD,2BAASC,OAAO,eAAeP,UAAWR,EAAgCgB,KAAK,WAElFf,KAAKH,MAAMmB,OAAS,yBAAOT,UAAU,sBAAsBP,KAAKH,MAAMmB,SAIvF,EA9BA,CAAoC,a,wBCZpC,0BACY,KAAAC,aAAyB,GAqFrC,OAhFW,YAAAC,WAAP,SAAkBC,GAEd,GAAInB,KAAKiB,aAAahD,OAAS,EAAG,MACdmD,IAAZpB,KAAKqB,KACLrB,KAAKqB,GAAK,GAGd,IAAMC,EAAStB,KAAKqB,GAAKrB,KAAKiB,aAAahD,OAAS+B,KAAKiB,aAAajB,KAAKqB,IAAMF,EAEjF,OADAnB,KAAKuB,cAAcvB,KAAKqB,IACjBC,EAGX,OAAOH,GAGJ,YAAAK,aAAP,SAAoBL,GAEhB,GAAInB,KAAKiB,aAAahD,OAAS,QAAmBmD,IAAdpB,KAAKyB,KAAoB,CACzD,IAAMH,EAAStB,KAAKiB,aAAajB,KAAKyB,MAEtC,OADAzB,KAAKuB,cAAcvB,KAAKyB,MACjBH,EAGX,OAAOH,GAGJ,YAAAO,IAAP,SAAWP,EAAcQ,GAMrB3B,KAAKiB,aACa,IAAdjB,KAAK4B,MAAc5B,KAAKiB,aAAahD,OAAS,GAAK+B,KAAKiB,aAAajB,KAAK4B,QAAUT,EAC9EnB,KAAKiB,aACL,aAACE,GAASnB,KAAKiB,cAGrBU,EACA3B,KAAK6B,QAIa,IAAd7B,KAAK4B,MACL5B,KAAKqB,QAAKD,EACVpB,KAAKyB,UAAOL,GACLpB,KAAK4B,OACZ5B,KAAKqB,GAAKrB,KAAK4B,KAAO,EACtB5B,KAAKyB,KAAOzB,KAAK4B,KAAO,IAK5B,YAAAC,MAAR,WACI7B,KAAKqB,QAAKD,EACVpB,KAAKyB,UAAOL,GAGR,YAAAG,cAAR,SAAsBO,GAElB9B,KAAK4B,KAAOE,EAGR9B,KAAKiB,aAAahD,OAAS,IACvB6D,EAAa9B,KAAKiB,aAAahD,OAC/B+B,KAAKqB,GAAKS,EAAa,GAEvB9B,KAAKqB,GAAKrB,KAAKiB,aAAahD,OAI5B6D,EAAa9B,KAAKiB,aAAahD,OAAS,GAGxC+B,KAAKyB,KADLK,EAAa,EACDA,EAAa,OAEbV,IAI5B,EAtFA,G,wBCsBA,SAASW,EAGPxD,EAASyD,GAEP,MAAO,CAAEzD,KAAI,EAAE0D,QAAS,CAAED,KAAI,EAAEE,iBAAkB,aAGtD,SAASC,EAAqB5D,GAC1B,MAAO,CAAEA,KAAI,EAAE0D,QAAS,CAAEC,iBAAkB,WAAYF,UAAMZ,IAI3D,IAAMgB,EAAiB,CAC1BC,WAAY,WAAoB,OAAAF,EAAqB,IAAiBG,cACtEC,cAAe,WAAoB,OAAAJ,EAAqB,IAAiBK,iBACzEC,gBAAiB,WAAoB,OAAAN,EAAqB,IAAiBO,mBAC3EC,eAAgB,WAAoB,OAAAR,EAAqB,IAA0BS,iBACnFC,WAAY,SAACC,GACT,OAAAf,EAAgC,IAAiBgB,YAAa,CAAED,OAAM,KAC1EE,KAAM,WAAoB,OAAAb,EAAqB,IAA0Bc,OACzEC,KAAM,WAAoB,OAAAf,EAAqB,IAA0BgB,OACzEC,UAAW,SAACC,GACR,OAAAtB,EAAgC,IAAiBuB,WAAY,CAAED,KAAI,KACvEE,SAAU,SAACC,GAAsB,OAAAzB,EAAgC,IAA0B0B,SAAUD,IACrGE,iBAAkB,SAACZ,GACf,OAAAf,EAAgC,IAAiB4B,mBAAoB,CAAEb,OAAM,KACjFc,SAAU,SAACd,GACP,OAAAf,EAAgC,IAAiB8B,UAAW,CAAEf,OAAM,KACxEgB,aAAc,SAAChB,GACX,OAAAf,EAAgC,IAAiBgC,eAAgB,CAAEjB,OAAM,KAC7EkB,WAAY,SAAClB,GACT,OAAAf,EAAgC,IAAiBkC,YAAa,CAAEnB,OAAM,KAC1EoB,mBAAoB,SAACpB,GACjB,OAAAf,EAAgC,IAAiBoC,sBAAuB,CAAErB,OAAM,KACpFsB,UAAW,SAACtB,GACR,OAAAf,EAAgC,IAAiBsC,WAAY,CAAEvB,OAAM,KACzEwB,SAAU,SAACxB,EAAgByB,GACvB,OAAAxC,EAAgC,IAAiByC,UAAW,CACxD1B,OAAM,EACNpC,QAAS6D,EAAEE,UACXC,QAASH,EAAEI,MAAMC,GACjBC,QAASN,EAAEM,QACXC,QAASP,EAAEO,QACXF,GAAI9B,EACJ3B,KAAMoD,EAAEI,MAAMI,cAEtBC,YAAa,SAAC7D,EAAc2B,GACxB,OAAAf,EAAgC,IAAiBkD,aAAc,CAAE9D,KAAI,EAAE2B,OAAM,KACjFoC,uBAAwB,WAAoB,OAAA/C,EAAqB,IAAiBgD,2BAClFC,0BAA2B,SAACC,EAAyBC,GACjD,OAAAvD,EAAgC,IAAiBwD,6BAA8B,CAAEF,gBAAe,EAAEC,WAAU,KAChHE,UAAW,WAAoB,OAAArD,EAAqB,IAA0BsD,YAC9EC,YAAa,WAAoB,OAAAvD,EAAqB,IAA0BwD,cAChFC,OAAQ,WAAoB,OAAAzD,EAAqB,IAAiB0D,SAClEC,SAAU,WAAoB,OAAA3D,EAAqB,IAAiB4D,qBACpEC,eAAgB,SAACC,EAA4BC,GACzC,OAAAnE,EAAgC,IAAiBoE,iBAAkB,CAAEF,SAAQ,EAAEC,WAAU,KAC7FE,aAAc,WAAoB,OAAAjE,EAAqB,IAAiBkE,gBACxEC,OAAQ,SAACC,GACL,OAAAxE,EAAgC,IAAiByE,OAAQ,CAAED,WAAU,KACzEE,QAAS,SAAC3D,GACN,OAAAf,EAAgC,IAAiB2E,aAAc,CAAE5D,OAAM,KAC3E6D,YAAa,SAAC7D,EAA4B4B,GACtC,OAAA3C,EAAgC,IAAiB6E,aAAc,CAAE9D,OAAM,EAAE4B,QAAO,KACpFmC,gBAAiB,WAAoB,OAAA1E,EAAqB,IAAiB2E,UAC3EC,aAAc,WAAoB,OAAA5E,EAAqB,IAA0B6E,eACjFC,aAAc,WAAoB,OAAA9E,EAAqB,IAAiB+E,gBACxEC,aAAc,SAACC,GACX,OAAArF,EAAgC,IAAiBsF,cAAe,CAAED,QAAO,KAC7EE,gBAAiB,SACbC,EACAC,EACAC,EACAC,GAEA,YAHA,IAAAD,MAAA,QACA,IAAAC,MAAA,KAEA3F,EAAgC,IAAiB4F,kBAAmB,CAChEC,eAAgBL,EAChBM,WAAY,OACZC,eAAe,EACfL,WAAU,EACVC,SAAQ,EACRF,aAAY,KAEpBO,aAAc,SAACC,GACX,OAAAjG,EAAgC,IAAiBkG,yBAA0BD,KC7DnF,cAKI,WAAYE,GAAZ,MACI,YAAMA,IAAK,K,OALP,EAAAC,QAAsC,cACtC,EAAAC,WAA8C,cAgE9C,EAAA1E,iBAAmB,WACvB,IAAMZ,EAAiB,EAAKuF,UAAUzD,GACtC,EAAK/E,MAAM6D,iBAAiBZ,IAGxB,EAAAuF,QAAU,WACd,OAAO,EAAKxI,MAAMyI,OAAOC,MAGrB,EAAAC,WAAa,WACjB,MAAiD,SAA1C,EAAK3I,MAAMyI,OAAOC,KAAKvG,KAAKyG,WAkD/B,EAAAC,oBAAsB,WAC1B,IAAMH,EAAO,EAAKF,UACZvF,EAASyF,EAAK3D,GAKd+D,GAAeJ,IAASA,EAAKK,MAAQL,EAAKK,OAAS,IAAYC,cAErE,OACI,uBAAKtI,UAAU,eAAezB,IAAK,GAC/B,gBAAC,IAAW,CACRgK,UAAW,EAAKjJ,MAAMiJ,UACtBrI,QAPO,WAAM,SAAKZ,MAAMqE,mBAAmBpB,IAQ3CiG,OACI,EAAKlJ,MAAMyI,OAAOC,KAAKS,QAAU,IAAUzJ,OAC3C,EAAKM,MAAMyI,OAAOC,KAAKS,QAAU,IAAUC,WACD,aAA1C,EAAKpJ,MAAMyI,OAAOC,KAAKvG,KAAKyG,YAC3B,EAAK5I,MAAMqJ,SAASC,kBAEzB9I,QAAS,YAAa,gCAAiC,eACvD+I,SAAU,EAAKvJ,MAAMyI,OAAOe,WAE5B,gBAAC,IAAK,CACFP,UAAW,EAAKjJ,MAAMiJ,UACtBQ,MAAM,qBACNC,MAAO,EAAK1J,MAAMyI,OAAOe,UAAY,IAAUG,KAAO,IAAUC,cAGxE,gBAAC,IAAW,CACRX,UAAW,EAAKjJ,MAAMiJ,UACtBrI,QA5BK,WAAM,SAAKZ,MAAM+D,SAASd,IA6B/BzC,QAAS,YAAa,oCAAqC,cAC3D0I,OAAQJ,GAER,gBAAC,IAAK,CACFG,UAAW,EAAKjJ,MAAMiJ,UACtBQ,MAAM,qBACNC,MAAO,IAAUG,kBAGzB,gBAAC,IAAW,CACRZ,UAAW,EAAKjJ,MAAMiJ,UACtBrI,QAtCK,WAAM,SAAKZ,MAAMiE,aAAahB,IAuCnCzC,QAAS,YAAa,4CAA6C,wBACnE0I,QAASJ,GAET,gBAAC,IAAK,CAACG,UAAW,EAAKjJ,MAAMiJ,UAAWQ,MAAM,qBAAqBC,MAAO,IAAUI,QAExF,gBAAC,IAAW,CACRb,UAAW,EAAKjJ,MAAMiJ,UACtBrI,QA/CO,WAAM,SAAKZ,MAAMgD,WAAWC,IAgDnCzC,QAAS,YAAa,kCAAmC,gBAEzD,gBAAC,IAAK,CAACyI,UAAW,EAAKjJ,MAAMiJ,UAAWQ,MAAM,qBAAqBC,MAAO,IAAUK,YAM5F,EAAAC,aAAe,SAACC,GAEpBA,EAAGC,kBACH,EAAKlK,MAAMuE,UAAU,EAAKvE,MAAMyI,OAAOC,KAAK3D,KAGxC,EAAAoF,eAAiB,WACrB,IAAMC,EACF,EAAKpK,MAAMyI,OAAOC,KAAKS,QAAU,IAAUkB,MAAQ,EAAKrK,MAAMyI,OAAOC,KAAKS,QAAU,IAAUC,UAC5FkB,EACF,EAAKtK,MAAMyI,OAAO8B,0BAClB,EAAKvK,MAAMyI,OAAO+B,iBACjB,EAAKxK,MAAMyI,OAAOgC,UACnB,EAAK9B,aACHZ,EACF,EAAK/H,MAAMyI,QACX,EAAKzI,MAAMyI,OAAOC,MAClB,EAAK1I,MAAMyI,OAAOC,KAAKvG,MACvB,EAAKnC,MAAMyI,OAAOC,KAAKvG,KAAKuI,gBACtB,EAAK1K,MAAMyI,OAAOC,KAAKvG,KAAKuI,gBAAgBC,WAC5C,IACJC,EAAiB,EAAK5K,MAAMyI,OAAOC,KAAK3D,KAAO,IAAY8F,WAC3DC,EAAUF,EAAiB,KAAO,EAAK/B,sBAE7C,OACI,uBAAKnI,UAAU,gBACX,gBAAC,IAAc,CACXqK,OAAQX,EACRY,MACIJ,GAAkB,EAAK5K,MAAMiL,mBAAqB,EAAKjL,MAAMiL,mBAAqBlD,EAEtFxH,QAAS,EAAKoI,eAElB,gBAAC,EAAc,CACXtI,MAAO,EAAKL,MAAMiJ,UAClB1I,QAAS+J,EACTlK,KAAM,EAAKJ,MAAMyI,OAAOyC,eACxBtK,QAAS,EAAKiD,iBACdrD,QAAS,YAAa,mCAAoC,0BAE7DsK,IAKL,EAAAK,YAAc,WAClB,OAAI,EAAKxC,aAED,gBAAC,IAAS,CACNF,OAAQ,EAAKzI,MAAMyI,OACnB2C,cAAe,EAAKpL,MAAMoL,cAC1BC,QAAS,EAAKC,aACdC,UAAW,EAAKvL,MAAMuL,UACtBC,aAAc,EAAKA,aACnBC,cAAe,EAAKA,cACpBC,UAAW,EAAKC,YAChBC,WAAU,EAAK5L,MAAM4L,SACrBC,cAAe,EAAK7L,MAAM6L,cAC1BC,IAAK,EAAKxD,QACVyD,YAAa,EAAK/L,MAAM+L,YACxBC,SAAU,EAAKA,SACfC,uBAAwB,EAAKjM,MAAMiM,uBACnCC,QAAS,EAAKC,aAAe,EAAKC,uBAAoB7K,EACtD8K,gBAAiB,EAAKrM,MAAMyI,OAAO4D,gBACnCC,KAAM,EAAKtM,MAAMsM,KACjBC,iBAAkB,EAAKvM,MAAMyI,OAAOC,KAAK3D,KAAO,IAAY8F,WAC5D2B,YAAa,EAAKxM,MAAMyI,OAAO+D,YAAc,EAAKxM,MAAMyI,OAAO+D,YAAc,EAC7EC,aAAc,EAAKzM,MAAMyM,aACzBC,SAAU,EAAK1M,MAAM0M,SACrBC,mBAAmB,IAIxB,MAOH,EAAAhB,YAAc,WAClB,EAAK3L,MAAM4G,QAAQ,EAAK4B,UAAUzD,KAG9B,EAAAyG,aAAe,SAAC9G,GACpB,EAAK1E,MAAMyE,SAAS,EAAK+D,UAAUzD,GAAIL,IAGnC,EAAA+G,cAAgB,SAACmB,EAAeC,EAAe5J,EAAgB4B,GACnE,EAAK7E,MAAM8G,YAAY7D,EAAQ4B,IAG3B,EAAAiI,UAAY,WAChB,OACI,EAAKtE,UAAUW,QAAU,IAAU4D,UACnC,EAAKvE,UAAUW,QAAU,IAAUzJ,OACnC,EAAK8I,UAAUW,QAAU,IAAUC,WAInC,EAAA4D,YAAc,WAClB,OAAO,EAAKhN,MAAMyI,OAAOC,KAAKvG,MAa1B,EAAA8K,UAAY,SAACC,GAEjB,GAAI,EAAK1E,UAAUzD,KAAO,IAAY8F,WAAY,CAC9C,IAAMnG,EAAoB,CACtBpD,KAAM4L,EAAMjO,IACZkO,SAAUD,EAAMC,SAChBC,QAASF,EAAME,QACfC,QAASH,EAAMG,QACfC,OAAQJ,EAAMI,OACd3O,OAAQuO,EAAMvO,OACduL,gBAAiB,WAAM,OAAAgD,EAAMhD,mBAC7BqD,eAAgB,WAAM,OAAAL,EAAMK,mBAEhC,EAAKnB,kBAAkB,IAAYvB,WAAYnG,KAI/C,EAAA8I,QAAU,SAACN,GAEf,GAAI,EAAK1E,UAAUzD,KAAO,IAAY8F,WAAY,CAC9C,IAAMnG,EAAoB,CACtBpD,KAAM4L,EAAMjO,IACZkO,SAAUD,EAAMC,SAChBC,QAASF,EAAME,QACfC,QAASH,EAAMG,QACfC,OAAQJ,EAAMI,OACd3O,OAAQuO,EAAMvO,OACduL,gBAAiB,WAAM,OAAAgD,EAAMhD,mBAC7BqD,eAAgB,WAAM,OAAAL,EAAMK,mBAEhC,EAAKE,gBAAgB,IAAY5C,WAAYnG,KAI7C,EAAA0H,kBAAoB,SAACsB,EAAiBhJ,GAC3B,UAAXA,EAAEpD,MAAoBoD,EAAEyI,UAEN,gBAAXzI,EAAEpD,MAA0BoD,EAAEyI,SADrC,EAAKQ,eAAejJ,GAGF,SAAXA,EAAEpD,MAAmBoD,EAAE0I,SAAW1I,EAAEkJ,aAAelJ,EAAEkJ,WAAWC,cACvEnJ,EAAEkJ,WAAWE,QACbpJ,EAAEwF,kBACFxF,EAAE6I,kBACgB,WAAX7I,EAAEpD,MAAsBoD,EAAEyI,WAAYzI,EAAEkJ,YAAelJ,EAAEkJ,WAAWC,eAC3EnJ,EAAEkJ,WAAWE,QACbpJ,EAAEwF,kBACFxF,EAAE6I,mBAIF,EAAAE,gBAAkB,SAACC,EAAiBhJ,GAGzB,WAAXA,EAAEpD,MAAqBoD,EAAEyI,UACzB,EAAKY,oBAAoBrJ,IAyCzB,EAAAqJ,oBAAsB,SAACrJ,GAC3B,IAAMsJ,EAAiBC,SAASC,cAChC,GAAuB,OAAnBF,EAAyB,CACzB,IAAMG,EAAc,EAAKC,YAAY,EAAGJ,GACpCG,IACAzJ,EAAEwF,kBACFxF,EAAE6I,iBACFY,EAAYE,WAKhB,EAAArC,SAAW,SAACsC,GAChB,EAAKtO,MAAMuD,UAAU+K,EAAI3D,aAjZzB,EAAKxB,MAAQ,CAAEoF,uBAAuB,GAClClG,EAAKI,OAAOC,KAAK3D,KAAO,IAAY8F,aACpC,EAAKS,aAAe,IAAI,G,EAiZpC,OA1ZqC,iBAa1B,YAAArL,OAAP,WACI,MAA8C,aAA1CE,KAAKH,MAAMyI,OAAOC,KAAKvG,KAAKyG,UACrB,gBAAC,IAAmB,CAAC4F,SAAUrO,KAAKH,MAAMyI,OAAOC,KAAKvG,KAAKqM,WAE3DrO,KAAKsO,oBAIb,YAAAC,mBAAP,SAA0BC,IAClBxO,KAAKH,MAAMyI,OAAOmG,UAAaD,EAAUlG,OAAOmG,UAAazO,KAAKH,MAAMyI,OAAOoG,SAC/E1O,KAAK2O,YAEL3O,KAAKH,MAAMyI,OAAOsG,cAAgBJ,EAAUlG,OAAOsG,aACnD5O,KAAK6O,kBAIN,YAAAC,sBAAP,SAA6BC,GACzB,OAAQ,EAAc/O,KAAKH,MAAOkP,IAG9B,YAAAF,eAAR,sBACQ7O,KAAKoI,YAAcpI,KAAKoI,WAAW4G,UAE9BhP,KAAKoI,WAAW4G,QAAgBC,gBACjCjP,KAAKoI,WAAW4G,QAAQC,eAAe,CAAEC,SAAU,OAAQC,MAAO,UAAWC,OAAQ,YAEzFpP,KAAKoI,WAAW4G,QAAQK,UAAU3N,IAAI,SACtC4N,YAAW,WACH,EAAKlH,WAAW4G,SAChB,EAAK5G,WAAW4G,QAAQK,UAAUE,OAAO,WAE9C,OAIH,YAAAZ,UAAR,WAEQ3O,KAAKoI,YAAcpI,KAAKoI,WAAW4G,UAE9BhP,KAAKoI,WAAW4G,QAAQQ,SAAS1B,SAASC,gBAC3C/N,KAAKoI,WAAW4G,QAAQd,QAMvBlO,KAAKoI,WAAW4G,QAAgBC,gBACjCjP,KAAKoI,WAAW4G,QAAQC,eAAe,CAAEC,SAAU,OAAQC,MAAO,UAAWC,OAAQ,cAkBzF,YAAAd,iBAAR,WACI,IAEMmB,EADFzP,KAAKH,MAAMqJ,SAASwG,mBAAqB1P,KAAKH,MAAMyI,OAAOqH,aAAe3P,KAAKH,MAAMyI,OAAOgC,UACvDtK,KAAK4P,sBACxCC,EAAiB7P,KAAKH,MAAMyI,OAAOgC,SAAW,sBAAwB,aACtEwF,EAAmB9P,KAAKH,MAAMyI,OAAOgC,SAAW,eAAiB,wCACjEyF,IAAuB/P,KAAKH,MAAMqJ,SAAS6G,qBAEjD,OAAIN,EAEI,uBACIlP,UAAWuP,EACXE,KAAMhQ,KAAKH,MAAMmQ,KACjBrE,IAAK3L,KAAKoI,WACV6H,SAAU,EACVnD,UAAW9M,KAAK8M,UAChBO,QAASrN,KAAKqN,QACd5M,QAAST,KAAK6J,cAEd,uBAAKtJ,UAAWsP,GACX7P,KAAKgK,iBACN,uBAAKzJ,UAAU,eACX,uBAAKA,UAAU,yBACVP,KAAKgL,cACN,2BACI,gBAAC,IAAU,CACP1C,OAAQtI,KAAKH,MAAMyI,OACnBQ,UAAW9I,KAAKH,MAAMiJ,UACtBoH,YAAalQ,KAAKH,MAAM0D,SACxB4M,YAAanQ,KAAKH,MAAMsQ,YACxBC,aAAcpQ,KAAKH,MAAMuQ,aACzBL,qBAAsBA,EACtBhI,aAAc/H,KAAKH,MAAMkI,aACzBZ,aAAcnH,KAAKH,MAAMsH,oBAWlD,MA2IH,YAAA6E,WAAR,WACI,OAAOhM,KAAKqI,UAAUzD,KAAO,IAAY8F,YA2BrC,YAAAkF,oBAAR,WACI,OACI5P,KAAKwI,cACLxI,KAAK2M,aACL3M,KAAK6M,cAAcwD,SACnBrQ,KAAK6M,cAAcwD,QAAQpS,OAAS,IACnC+B,KAAKH,MAAMyI,OAAOgI,YA8DnB,YAAA9C,eAAR,SAAuBjJ,GACnB,GAAIA,EAAEkJ,YAAclJ,EAAEkJ,WAAW8C,SAAU,CAEvChM,EAAEwF,kBACFxF,EAAE6I,iBAIF,IADA,IAAIoD,EAASjM,EAAEkJ,WAAW8C,SAAStS,OAAS,EACrCuS,GAAU,GAAuC,OAAlCjM,EAAEkJ,WAAW8C,SAASC,IACxCA,GAAU,EAEd,IAAMC,EAAUlM,EAAEkJ,WAAW8C,SAASG,MAAM,EAAGF,EAAS,GAGpDxQ,KAAKmL,cACLnL,KAAKmL,aAAazJ,IAAI+O,EAASlM,EAAEkJ,WAAWkD,SAIhDpM,EAAEkJ,WAAWE,QAGb3N,KAAKH,MAAMmF,YAAYyL,EAASzQ,KAAKH,MAAMyI,OAAOC,KAAK3D,MAIvD,YAAAqJ,YAAR,SAAoB2C,EAAmBC,GACnC,GAAIA,EAAS,CACT,IAAMC,EAAehD,SAASiD,iBAAiB,4CAC/C,GAAID,EAAc,CACd,IAAME,EAAUC,MAAMhS,UAAUiS,OAAO/R,KAAK2R,GAAc,SAAC/S,GAAmB,OAAAA,EAAEkS,UAAY,KACtFkB,EAAOH,EAAQI,QAAQP,GAC7B,OAAOD,GAAa,EAAII,EAAQG,EAAO,IAAMH,EAAQ,GAAKA,EAAQG,EAAO,IAAMH,EAAQ,MAoBvG,EA1ZA,CAAqC,aA6ZxBK,EAA2B,YAAQ,KAAMjP,EAAd,CAA8B,G,UCtbtE,SAASkP,EAAgBtI,GACrB,OAAO,2BAAKA,EAAMuI,MAAI,CAAEC,cAAexI,EAAMyI,YAGjD,kBAOI,WAAY5R,GAAZ,MACI,YAAMA,IAAM,K,OAPR,EAAA6R,aAAgD,cAChD,EAAAC,oBAAuD,cACvD,EAAAC,gBAAiD,cACjD,EAAAC,YAAsB,EACtB,EAAAC,oBAA8B,EA4D9B,EAAAC,iBAAmB,SAACC,GACxB,EAAKnS,MAAMwC,cAiNP,EAAA4P,uBAAyB,WAC7B,OAAO,EAAKpS,MAAMqS,sBAAwB,GAGtC,EAAAC,gBAAkB,SAACrJ,GACvB,MAAO,CACHA,UAAWA,EACXsJ,QAAS,EAAKvS,MAAMuS,QACpB3G,SAAU,EAAK5L,MAAM4L,SACrBL,UAAW,EAAKvL,MAAMuL,UACtBiH,cAAe,EAAKxS,MAAMwS,cAC1BnJ,SAAU,EAAKrJ,MAAMqJ,SACrBoJ,iBAAgB,EAAKzS,MAAMyS,eAC3BhI,UAAU,EACViI,WAAY,EAAKA,WACjBC,eAAgB,EAAKC,UACrBC,uBAAsB,EAAK7S,MAAMqJ,UAC3B,EAAKrJ,MAAMqJ,SAASyJ,cAAcC,OAAOF,uBAI/C,EAAAG,iBAAmB,SAAC/J,GACxB,IAAIgK,EAAgB,EAIpB,OAHI,EAAKnB,oBAAoB3C,UACzB8D,EAAgB,EAAKnB,oBAAoB3C,QAAQ+D,cAE9C,CACHzN,WAAY,EAAKzF,MAAM2R,cAAclM,WACrCD,gBAAiB,EAAKxF,MAAM2R,cAAcnM,gBAC1CoM,UAAW,EAAK5R,MAAM2R,cAAcC,UACpCuB,UAAW,EAAKnT,MAAMmT,UACtB/I,KAAM,EAAKpK,MAAMoK,KACjBgJ,iBAAkB,EAAKpT,MAAMmG,eAC7BkN,YAAa,EAAKrT,MAAMqT,YACxBzH,SAAU,EAAK5L,MAAM4L,SACrB0H,sBAAuB,EAAKtT,MAAMqF,uBAClCE,0BAA2B,EAAKvF,MAAMuF,0BACtC0D,UAAWA,EACXsK,OAAQ,EAAKC,mBACbC,SAAU,EAAKzT,MAAMsM,KAAKoH,KAC1B3L,eAAgB,EAAK/H,MAAMqS,sBAC3B1K,aAAc,EAAK3H,MAAM2R,cAAchK,aACvCuL,aAAcD,EACdU,qBACI,EAAK3T,MAAMqJ,WAAY,EAAKrJ,MAAMqJ,SAASuK,kBACrC,EAAK5T,MAAMqJ,SAASuK,gBAAgBC,uBAK9C,EAAAL,mBAAqB,SAAC5L,EAAoBC,GAC9C,EAAK7H,MAAMyH,gBACP,EAAKzH,MAAMqS,sBACX,EAAKrS,MAAM2R,cAAchK,aACzBC,EACAC,IAIA,EAAA6K,WAAa,SACjBjK,EACAqL,EACAC,GAIA,GAAI,EAAK/T,MAAMqJ,UAAY,EAAKrJ,MAAMoL,cAAe,CAEjD,IAAM4I,EAAU,2BAAK,EAAKhU,MAAMoL,eAAa,CAAE6I,MAAO,CAAEC,QAASzL,EAAOyC,kBACxE,OACI,uBAAKjM,IAAKwJ,EAAOC,KAAK3D,GAAIA,GAAI0D,EAAOC,KAAK3D,GAAI+G,IAAKiI,GAC/C,gBAAC,IAAa,KACV,gBAACvC,EAAwB,CACrBrB,KAAK,WACL/E,cAAe4I,EACf1D,iBAAa/O,EACbgP,cAAc,EACd4D,WAAW,EACXvI,SAAU,EAAK5L,MAAM4L,SACrBnD,OAAQA,EACRQ,UAAW,EAAKjJ,MAAMiJ,UACtBsC,UAAW,EAAKvL,MAAMuL,UACtBM,cAAepD,EAAOC,KAAK3D,KAAO,IAAY8F,WAC9CI,mBAAoB,EAAKmH,yBAAyBzH,WAClDoB,YAAa,EAAK/L,MAAM+L,YACxBO,KAAM,EAAKtM,MAAMsM,KACjBjD,SAAU,EAAKrJ,MAAMqJ,SACrBoD,aAAc,EAAKzM,MAAMyM,aACzBC,SAAU,EAAK1M,MAAMoU,OAAO1H,aAM5C,OAAO,MAOP,EAAAkG,UAAY,SAACyB,GACb,EAAKrU,MAAM0G,aACX,EAAKuL,qBAAuB,EAGxBoC,GAAOA,EAAIjF,gBACXiF,EAAIjF,eAAe,CAAEC,SAAU,OAAQC,MAAO,UAAWC,OAAQ,cAKrE,EAAA+E,aAAe,SAAC5P,G,MACpB,GAAI,EAAKuN,oBAAsB,EAC3B,EAAKA,qBAAuB,OACzB,GAAI,EAAKF,gBAAgB5C,QAAS,CACrC,IAAMzI,KAAgC,QAAnB,IAAK1G,MAAMqJ,gBAAQ,eAAEkL,wBAElC,EAAKxC,gBAAgB5C,QAAQqF,kBAAkB9P,EAAE+P,eACvD,EAAKzU,MAAMyG,OAAOC,KAIlB,EAAAnD,UAAY,SAAC0G,GACjB,YAAgBA,EAAI,EAAKjK,MAAMuD,Y,EAEvC,OAjZsC,iBAW3B,YAAAmR,kBAAP,WACIzG,SAAS0G,iBAAiB,QAASxU,KAAKoD,WAAW,GACnDpD,KAAKH,MAAMuG,gBAGR,YAAAqO,qBAAP,WACI3G,SAAS4G,oBAAoB,QAAS1U,KAAKoD,WAC3CpD,KAAKH,MAAMgH,mBAGR,YAAA/G,OAAP,WACI,IAAM6U,EAAmC,CACrCrB,SAAUtT,KAAKH,MAAMsM,KAAKoH,KAC1BqB,WAAY5U,KAAKH,MAAMsM,KAAK0I,QAG1BC,GAAe9U,KAAKH,MAAMoK,MAASjK,KAAKH,MAAMkV,QAAY/U,KAAKH,MAAM4L,cAA0BrK,EAAf,gBAAC,IAAQ,MAO/F,OAJIpB,KAAKH,MAAM4L,WACXzL,KAAK6R,YAAc7R,KAAK6R,YAAc,GAItC,uBAAKjN,GAAG,aAAa+G,IAAK3L,KAAK0R,aAAc1B,KAAK,OAAOgF,MAAOL,GAC5D,uBAAKpU,UAAU,eACX,8BAAWP,KAAKH,MAAMoV,QAAUjV,KAAKH,MAAMoV,QAAU,IAAE,KACzE,OAAAC,EAAA,GAAiBlV,KAAKH,MAAMqJ,YAEd,0BAAQtE,GAAG,qBAAqB+G,IAAK3L,KAAK2R,qBACrC3R,KAAKmV,qBACLL,GAEL,2BACIlQ,GAAG,sBAAqB,aACZ,YAAa,4CAA6C,cAErE5E,KAAKoV,oBAAoBpV,KAAKH,MAAMiJ,YAEzC,wBAAMlE,GAAG,qBAAqByQ,SAAUrV,KAAKmU,cACxCnU,KAAKsV,mBAAmBtV,KAAKH,MAAMiJ,YAExC,2BACIlE,GAAG,oBACHnE,QAAST,KAAK+R,iBAAgB,aAClB,YAAa,0BAA2B,yBAEnD/R,KAAKuV,kBAAkBvV,KAAKH,MAAMiJ,cAY3C,YAAAqM,mBAAR,WACI,IAAMK,EAA0BxV,KAAKH,MAAM2R,cAAcpR,QACnD,YAAa,8CAA+C,2CAC5D,YAAa,4CAA6C,2CAEhE,OACI,uBAAKwE,GAAG,iBACJ,uBAAKrE,UAAU,oBACX,uBAAKA,UAAU,0BACX,gBAAC,IAAW,CACRuI,UAAW9I,KAAKH,MAAMiJ,UACtBrI,QAAST,KAAKH,MAAM8C,eACpBtC,QAAS,YAAa,uBAAwB,qBAE9C,gBAAC,IAAK,CACFyI,UAAW9I,KAAKH,MAAMiJ,UACtBQ,MAAM,qBACNC,MAAO,IAAUK,UAGzB,gBAAC,IAAW,CACRd,UAAW9I,KAAKH,MAAMiJ,UACtBrI,QAAST,KAAKH,MAAMqD,KACpBkG,SAA0C,IAAhCpJ,KAAKH,MAAM4V,UAAUxX,OAC/BoC,QAAS,YAAa,mBAAoB,SAE1C,gBAAC,IAAK,CAACyI,UAAW9I,KAAKH,MAAMiJ,UAAWQ,MAAM,qBAAqBC,MAAO,IAAUpG,QAExF,gBAAC,IAAW,CACR2F,UAAW9I,KAAKH,MAAMiJ,UACtBrI,QAAST,KAAKH,MAAMmD,KACpBoG,SAA0C,IAAhCpJ,KAAKH,MAAM6V,UAAUzX,OAC/BoC,QAAS,YAAa,mBAAoB,SAE1C,gBAAC,IAAK,CAACyI,UAAW9I,KAAKH,MAAMiJ,UAAWQ,MAAM,qBAAqBC,MAAO,IAAUtG,QAExF,gBAAC,IAAW,CACR6F,UAAW9I,KAAKH,MAAMiJ,UACtBrI,QAAST,KAAKH,MAAM0C,cACpBlC,QAAS,YAAa,4BAA6B,2BAEnD,gBAAC,IAAK,CACFyI,UAAW9I,KAAKH,MAAMiJ,UACtBQ,MAAM,qBACNC,MAAO,IAAUoM,WAGzB,gBAAC,IAAW,CACR7M,UAAW9I,KAAKH,MAAMiJ,UACtBrI,QAAST,KAAKH,MAAM4C,gBACpBpC,QAAS,YAAa,8BAA+B,6BAErD,gBAAC,IAAK,CACFyI,UAAW9I,KAAKH,MAAMiJ,UACtBQ,MAAM,qBACNC,MAAO,IAAUqM,aAGzB,gBAAC,IAAW,CACR9M,UAAW9I,KAAKH,MAAMiJ,UACtBrI,QAAST,KAAKH,MAAMqF,uBACpB7E,QAASmV,GAET,gBAAC,IAAK,CACF1M,UAAW9I,KAAKH,MAAMiJ,UACtBQ,MAAM,qBACNC,MAAO,IAAUsM,oBAGzB,gBAAC,IAAW,CACR/M,UAAW9I,KAAKH,MAAMiJ,UACtBrI,QAAST,KAAKH,MAAM+F,OACpBwD,SAAwC,IAA9BpJ,KAAKH,MAAMuS,QAAQnU,QAAgB+B,KAAKH,MAAMoK,KACxD5J,QAAS,YAAa,qBAAsB,+BAE5C,gBAAC,IAAK,CACFyI,UAAW9I,KAAKH,MAAMiJ,UACtBQ,MAAM,qBACNC,MAAO,IAAUuM,UAGzB,gBAAC,IAAW,CACRhN,UAAW9I,KAAKH,MAAMiJ,UACtBrI,QAAST,KAAKH,MAAMiG,SACpBsD,SAAUpJ,KAAKH,MAAMoK,OAASjK,KAAKH,MAAM2M,kBACzCjM,UAAU,gBACVF,QAAS,YAAa,+BAAgC,cAEtD,gBAAC,IAAK,CACFyI,UAAW9I,KAAKH,MAAMiJ,UACtBQ,MAAM,qBACNC,MAAO,IAAUwM,kBAGzB,gBAAC,IAAW,CACRjN,UAAW9I,KAAKH,MAAMiJ,UACtBrI,QAAST,KAAKH,MAAM2F,UACpB4D,SAAwC,IAA9BpJ,KAAKH,MAAMuS,QAAQnU,OAC7BoC,QAAS,YAAa,wBAAyB,2BAE/C,gBAAC,IAAK,CACFyI,UAAW9I,KAAKH,MAAMiJ,UACtBQ,MAAM,qBACNC,MAAO,IAAU9D,aAGzB,gBAAC,IAAW,CACRqD,UAAW9I,KAAKH,MAAMiJ,UACtBrI,QAAST,KAAKH,MAAM6F,YACpB0D,SAAwC,IAA9BpJ,KAAKH,MAAMuS,QAAQnU,OAC7BoC,QAAS,YAAa,0BAA2B,6BAEjD,gBAAC,IAAK,CACFyI,UAAW9I,KAAKH,MAAMiJ,UACtBQ,MAAM,qBACNC,MAAO,IAAU5D,gBAI5B3F,KAAKgW,2BAMd,YAAAA,sBAAR,WACI,GAAIhW,KAAKH,MAAMoU,OAAOgC,aAAe,YAAa,iCAAkC,SAIpF,OACI,gBAAC,IAAW,CACRnN,UAAW9I,KAAKH,MAAMiJ,UACtBqD,KAAMnM,KAAKH,MAAMsM,KACjB8H,OAAQjU,KAAKH,MAAMoU,OACnBhN,aAAcjH,KAAKH,MAAMoH,aACzBF,aAAc/G,KAAKH,MAAMkH,aACzBmP,wBAAwB,KAK5B,YAAAd,oBAAR,SAA4BtM,GACxB,GAAI9I,KAAKH,MAAM2R,cAAcpR,QAAS,CAClC,IAAM+V,EAAgBnW,KAAK6S,iBAAiB/J,GAC5C,OAAO,gBAAC,IAAa,eAAKqN,IAG9B,OAAO,MAGH,YAAAb,mBAAR,SAA2BxM,GAGvB,IAAK9I,KAAKH,MAAMuW,cAAgBpW,KAAKH,MAAM4L,SACvC,OAAO,KAIX,IAAM4K,EAAerW,KAAKmS,gBAAgBrJ,GAC1C,OAAO,gBAAC,IAAY,eAAKuN,EAAY,CAAE1K,IAAK3L,KAAK4R,oBAG7C,YAAA2D,kBAAR,SAA0BzM,GAGtB,KACK9I,KAAKH,MAAMuW,aACXpW,KAAKH,MAAMyW,YACXtW,KAAKH,MAAMqJ,UACXlJ,KAAKH,MAAMoL,eACXjL,KAAKH,MAAMqJ,SAASqN,YAErB,OAAO,KAGX,IAAM3O,EAAiB5H,KAAKiS,yBACtBuE,EAAiBxW,KAAKH,MAAMqJ,SAASuN,iBAAmB,uBAAyB,aAEvF,OACI,uBAAKlW,UAAWiW,GACZ,gBAAC,IAAa,KACV,gBAACnF,EAAwB,CACrBrB,KAAK,OACL/E,cAAejL,KAAKH,MAAMoL,cAC1BkF,iBAAa/O,EACbgP,cAAc,EACd4D,UAAWlG,SAAS4I,WACpBjL,SAAUzL,KAAKH,MAAM4L,SACrBnD,OAAQtI,KAAKH,MAAMyW,WACnBxN,UAAWA,EACXsC,UAAWpL,KAAKH,MAAMuL,UACtBM,eAAe,EACfZ,mBAAoBlD,EAAe4C,WACnCoB,YAAa5L,KAAKH,MAAM+L,YACxBO,KAAMnM,KAAKH,MAAMsM,KACjBjD,SAAUlJ,KAAKH,MAAMqJ,SACrBoD,aAActM,KAAKH,MAAMyM,aACzBC,SAAUvM,KAAKH,MAAMoU,OAAO1H,cAqIpD,EAjZA,CAAsC,a,ICbrB,E,6GAAjB,SAAiBoK,GACb,SAASC,EAAgB5N,EAAmBT,GAExC,OAAIS,EAAMyC,UACyB,aAAxBlD,EAAKvG,KAAKyG,UAazB,SAAgBoO,EACZvO,EACAY,EACA9I,EACA0W,GAEA,GAAmC,SAA/BxO,EAAOC,KAAKvG,KAAKyG,UAAsB,CAEvC,GAAIH,EAAO+B,iBAAmBjK,GAAWkI,EAAOyC,iBAAmB+L,EAC/D,OAAOxO,EAGX,IAAMyO,EAAY,eAAKzO,GAYvB,GAXIA,EAAO+B,iBAAmBjK,IAGtB2W,EAAU1M,iBAFVjK,GAUJkI,EAAOyC,iBAAmB+L,GAAYxO,EAAO8B,0BAA4B9B,EAAO+B,eAAgB,CAChG,IAAI2M,EAjChB,SAA+B1O,EAAwBY,GAEnD,IAAM+N,EAAO,YAAiB3O,EAAQY,GAGtC,OAAO,YAA4B+N,GA4BbC,CAAsB5O,EAAQY,GAGxC8N,EAAQG,SAAS,MACbL,GAEAC,EAAUhM,gBAAiB,EAC3BgM,EAAUK,eAAiBJ,IAGvBA,EAAQ/Y,OAAS,IAGjB+Y,GADAA,GADAA,EAAUA,EAAQK,MAAM,KAAM,GAAG,IACf3G,MAAM,EAAG,MACT4G,OAAO,QAG7BP,EAAUhM,gBAAiB,EAC3BgM,EAAUK,eAAiBJ,IAI/BD,EAAU3M,0BAA2B,EACrC2M,EAAUhM,gBAAiB,EAC3BgM,EAAUK,eAAiBJ,GAInC,OAAOD,EAGX,OAAOzO,EAGX,SAAgBiP,EAAchP,EAAaiP,G,MACnClP,EAAyB,YAAaC,EAAMiP,EAAUtO,UAAU,EAAOsO,EAAUxE,WAE/E5S,IAAUoX,EAAUtO,UAAWsO,EAAUtO,SAASwG,kBAClDoH,IAA8B,QAAnB,EAACU,EAAUtO,gBAAQ,eAAEuO,gCAMtC,OAHAnP,EAASuO,EAAYvO,EAAQkP,EAAUtO,SAAU9I,EAAS0W,IACnDY,YAAa,EAEbpP,EApEK,EAAAuO,YAAW,EA0DX,EAAAU,cAAa,EAab,EAAAI,UAAhB,SAA0BC,GACtB,GAAIhB,EAAgBgB,EAAIC,UAAWD,EAAI3V,QAAQD,MAAO,CAClD,IAAMV,EAAS,IAAQwW,YAAYF,EAAKL,GACxC,GACIjW,EAAO8Q,QAAQnU,OAAS2Z,EAAIC,UAAUzF,QAAQnU,QAC9C2Z,EAAI3V,QAAQD,KAAK4C,KAAO,IAAY8F,WACtC,CACE,IAAMpC,EAAShH,EAAO8Q,QAAQ9Q,EAAO8Q,QAAQnU,OAAS,GAGtD,YAAsB2Z,EAAK,IAA0BG,YAAa,CAC9DC,OAAQ,OACRC,KAAM,MACNC,SAAUN,EAAIC,UAAUM,MACxBC,UAAU,EACV7P,KAAMD,EAAOC,KACb8P,SAAU,YAAiB/P,EAAQhH,EAAO4H,UAC1CoP,YAAahQ,EAAO8O,iBAI5B,OAAO9V,EAEX,OAAOsW,EAAIC,WAGC,EAAAU,WAAhB,SAA2BX,GACvB,OAAIhB,EAAgBgB,EAAIC,UAAWD,EAAI3V,QAAQD,MACpC,IAAQ8V,YAAYF,EAAKL,GAE7BK,EAAIC,WAGC,EAAAW,WAAhB,SAA2BZ,GACvB,OAAIhB,EAAgBgB,EAAIC,UAAWD,EAAI3V,QAAQD,KAAKuG,MACzC,IAAQuP,YAAY,2BAClBF,GAAG,CAAE3V,QAAS,2BAAK2V,EAAI3V,SAAO,CAAED,KAAM4V,EAAI3V,QAAQD,KAAKuG,SAC5DgP,GAGDK,EAAIC,WAGC,EAAAlV,eAAhB,SAA+BiV,GAI3B,OAFA,YAAsBA,EAAK,IAA0BhV,gBAE9C,2BACAgV,EAAIC,WAAS,CAChBzF,QAAS,GACTsD,UAAW,IAAQ+C,UAAUb,EAAIC,UAAUnC,UAAWkC,EAAIC,UAAUzF,YAI5D,EAAAvP,WAAhB,SAA2B+U,GACvB,IAAMc,EAAQd,EAAIC,UAAUzF,QAAQuG,WAAU,SAACC,GAAM,OAAAA,EAAErQ,KAAK3D,KAAOgT,EAAI3V,QAAQD,KAAKc,UACpF,GAAI4V,GAAS,GAAKd,EAAI3V,QAAQD,KAAKc,OAAQ,CAEvC,YAAsB8U,EAAK,IAA0BG,YAAa,CAC9DC,OAAQ,OACRC,KAAM,SACNS,MAAK,EACLR,SAAUN,EAAIC,UAAUM,MACxBC,UAAU,EACV7P,KAAMqP,EAAIC,UAAUzF,QAAQsG,GAAOnQ,OAGvC,IAAMsQ,EAASjB,EAAIC,UAAUzF,QAAQlB,QAAO,SAAC4H,EAAI/a,GAAM,OAAAA,IAAM2a,KAC7D,OAAO,2BACAd,EAAIC,WAAS,CAChBzF,QAASyG,EACTnD,UAAW,IAAQ+C,UAAUb,EAAIC,UAAUnC,UAAWkC,EAAIC,UAAUzF,WAI5E,OAAOwF,EAAIC,WAGC,EAAAkB,QAAhB,SAAwBnB,GACpB,OAAO,2BACAA,EAAIC,WAAS,CAChBzF,QAAS,GACTsD,UAAW,GACXD,UAAW,GACXa,gBAAYlV,KAIJ,EAAA2T,OAAhB,SAAuB6C,GAInB,OAHA,YAAsBA,EAAK,IAA0BoB,qBAAsB,CACvEC,MAAO,KAEJ,2BACArB,EAAIC,WAAS,CAChB9C,QAAQ,EACR9K,MAAM,KAvLlB,CAAiB,MAAQ,K,ICDR,EAAAiP,E,aAAAA,EAAA,MAAO,KACJ1T,UAAhB,SAA0BoS,G,MACtB,GAA0B,QAA1B,EAAIA,EAAIC,UAAU3O,gBAAQ,eAAEwG,kBAAmB,CAC3C,IAAMmJ,EAASjB,EAAIC,UAAUzF,QAAQ+G,KAAI,SAACP,GACtC,SAAS/B,YAAY,eAAK+B,GAAKhB,EAAIC,UAAU3O,UAAU,GAAM,MAEjE,OAAO,2BACA0O,EAAIC,WAAS,CAChBzF,QAASyG,IAGjB,OAAOjB,EAAIC,WAGC,EAAAnS,YAAhB,SAA4BkS,G,MACxB,GAA0B,QAA1B,EAAIA,EAAIC,UAAU3O,gBAAQ,eAAEwG,kBAAmB,CAC3C,IAAMmJ,EAASjB,EAAIC,UAAUzF,QAAQ+G,KAAI,SAACP,GACtC,SAAS/B,YAAY,eAAK+B,GAAKhB,EAAIC,UAAU3O,UAAU,GAAM,MAEjE,OAAO,2BACA0O,EAAIC,WAAS,CAChBzF,QAASyG,IAGjB,OAAOjB,EAAIC,WAGC,EAAAnU,iBAAhB,SAAiCkU,GAC7B,GAAIA,EAAI3V,QAAQD,KAAKc,OAAQ,CACzB,IAAM+V,EAAS,YAAIjB,EAAIC,UAAUzF,SAC3BsG,EAAQd,EAAIC,UAAUzF,QAAQuG,WAAU,SAACC,GAAM,OAAAA,EAAErQ,KAAK3D,KAAOgT,EAAI3V,QAAQD,KAAKc,UAC9EsW,EAAQxB,EAAIC,UAAUzF,QAAQsG,GAEpC,OADAG,EAAOH,GAAS,EAAS7B,YAAY,eAAKuC,GAASxB,EAAIC,UAAU3O,UAAU,GAAOkQ,EAAMrO,gBACjF,2BACA6M,EAAIC,WAAS,CAChBzF,QAASyG,IAGjB,OAAOjB,EAAIC,WAGC,EAAAwB,eAAhB,SAA+BzB,G,MAGrB0B,EADkBC,KAAKC,MAAM5B,EAAI3V,QAAQD,MAEzCyX,EAAmB,YAAqBH,GACxCI,EAAgBJ,EAAY3G,cAC5B2G,EAAY3G,cAAcC,OAAOgC,WACjCgD,EAAIC,UAAU1L,KAAK0I,OACnB8E,EAAcL,EAAY3G,cAC1B2G,EAAY3G,cAAcC,OAAOU,SACjCsE,EAAIC,UAAU1L,KAAKoH,KAGzB,GACI+F,GACAA,EAAY3G,eACZ2G,EAAY3G,cAAczS,QAAU0X,EAAIC,UAAU+B,gBACpD,CACE,IAAMC,EAAY,IAAQC,iBAAiBR,GAE3C,YAAsB1B,EAAK,IAAYmC,cAAe,CAAEC,OAAQH,IAChE,YAAsBjC,EAAK,IAAYqC,sBAAuB,CAAED,OAAQH,IAI5E,IAAIhB,EAASjB,EAAIC,UAAUzF,QAY3B,OAXIkH,EAAY5J,qBAA4C,QAA3B,EAAKkI,EAAIC,UAAU3O,gBAAQ,eAAEwG,qBAC1DmJ,EAASjB,EAAIC,UAAUzF,QAAQ+G,KAAI,SAACP,GAChC,SAAS/B,YACL+B,EACAU,EACAA,EAAY5J,mBACX4J,EAAY7B,oCAKlB,2BACAG,EAAIC,WAAS,CAChBzF,QAASyG,EACT3P,SAAUoQ,EACVrO,cAAewO,EACftN,KAAM,CACFoH,KAAMoG,EACN9E,OAAQ6E,MAKJ,EAAAQ,aAAhB,SAA6BtC,GAEzB,IAAMc,EAAQd,EAAIC,UAAUzF,QAAQuG,WAAU,SAACC,GAAM,OAAAA,EAAErQ,KAAK3D,KAAOgT,EAAI3V,QAAQD,KAAK4C,MACpF,GAAI8T,GAAS,EAAG,CACZ,IAAMG,EAAS,YAAIjB,EAAIC,UAAUzF,SAIjC,OADAyG,EAAOH,GAAS,2BAAKG,EAAOH,IAAM,CAAE9J,YAAaiK,EAAOH,GAAO9J,YAAc,IACtE,2BACAgJ,EAAIC,WAAS,CAChBzF,QAASyG,IAIjB,OAAOjB,EAAIC,WAGC,EAAAsC,SAAhB,SAAyBvC,GACrB,OAAO,2BACAA,EAAIC,WAAS,CAChBtR,WAAYqR,EAAI3V,QAAQD,KAAKuE,cAIrB,EAAAnC,UAAhB,SAA0BwT,GACtB,OACIA,EAAI3V,QAAQD,KAAKc,SAAW,IAAY4H,YACxCkN,EAAIC,UAAUvB,aACbsB,EAAIC,UAAUvB,WAAW5H,QAEnB,2BACAkJ,EAAIC,WAAS,CAChBvB,WAAY,2BACLsB,EAAIC,UAAUvB,YAAU,CAC3B5H,SAAS,MAGVkJ,EAAIC,UAAUvB,WACd,2BACAsB,EAAIC,WAAS,CAChBvB,WAAY,2BACLsB,EAAIC,UAAUvB,YAAU,CAC3B5H,SAAS,MAKdkJ,EAAIC,WAGC,EAAAuC,YAAhB,SAA4BxC,GACxB,OACIA,EAAI3V,QAAQD,KAAKc,SAAW,IAAY4H,YACxCkN,EAAIC,UAAUvB,YACdsB,EAAIC,UAAUvB,WAAW5H,QAElB,2BACAkJ,EAAIC,WAAS,CAChBvB,WAAY,2BACLsB,EAAIC,UAAUvB,YAAU,CAC3B5H,SAAS,MAKdkJ,EAAIC,W,ICvJF,EAAAwC,E,yCAfXC,GAAY,EAAQ,SAeTD,EAAA,MAAS,KACNrX,KAAhB,SAAqB4U,GACjB,GAAIA,EAAIC,UAAUnC,UAAUzX,OAAS,EAAG,CAEpC,IAAMgb,EAAQrB,EAAIC,UAAUnC,UAAUkC,EAAIC,UAAUnC,UAAUzX,OAAS,GACjEyX,EAAYkC,EAAIC,UAAUnC,UAAUhF,MAAM,EAAGkH,EAAIC,UAAUnC,UAAUzX,OAAS,GAC9EwX,EAAY,IAAQgD,UAAUb,EAAIC,UAAUpC,UAAWmC,EAAIC,UAAUzF,SAE3E,OADA,YAAsBwF,EAAK,IAA0B3U,MAC9C,2BACA2U,EAAIC,WAAS,CAChBzF,QAAS6G,EACTvD,UAAWA,EACXD,UAAWA,EACXnD,gBAAgB,IAIxB,OAAOsF,EAAIC,WAGC,EAAA3U,KAAhB,SAAqB0U,GACjB,GAAIA,EAAIC,UAAUpC,UAAUxX,OAAS,EAAG,CAEpC,IAAMgb,EAAQrB,EAAIC,UAAUpC,UAAUmC,EAAIC,UAAUpC,UAAUxX,OAAS,GACjEwX,EAAYmC,EAAIC,UAAUpC,UAAU/E,MAAM,EAAGkH,EAAIC,UAAUpC,UAAUxX,OAAS,GAC9EyX,EAAY,IAAQ+C,UAAUb,EAAIC,UAAUnC,UAAWkC,EAAIC,UAAUzF,SAE3E,OADA,YAAsBwF,EAAK,IAA0BzU,MAC9C,2BACAyU,EAAIC,WAAS,CAChBzF,QAAS6G,EACTvD,UAAWA,EACXD,UAAWA,EACXnD,gBAAgB,IAIxB,OAAOsF,EAAIC,WAGC,EAAA0C,eAAhB,SAA+B3C,GAC3B,OAAO,2BACAA,EAAIC,WAAS,CAChB7E,WAAW,KAIH,EAAAwH,cAAhB,SAA8B5C,GAC1B,OAAO,2BACAA,EAAIC,WAAS,CAChB7E,WAAW,KAIH,EAAAhO,YAAhB,SAA4B4S,GAExB,IAAM6C,EAAU,IAAI,KAAY7C,EAAIC,UAAU3O,UAC9C,GAAIuR,EAAQC,iBAAiB9C,EAAI3V,QAAQD,KAAKb,MAAMlD,OAAS,GAAK2Z,EAAIC,UAAUvB,WAAY,CAExF,IAAIqE,EAAUL,GAAU1C,EAAIC,UAAUvB,YAGtCqE,EAAQpS,KAAKS,MAAQ,IAAUC,UAC/B0R,EAAQpS,KAAKvG,KAAKgW,OAASJ,EAAI3V,QAAQD,KAAKb,KAG5C,IAAMkW,EAAQO,EAAI3V,QAAQD,KAAKb,KAAKyZ,WAAW,CAAEC,MAAM,IACjDC,EAAYzD,EAAM,GACpBoD,EAAQM,WAAWD,IACnBH,EAAQpS,KAAKvG,KAAO,aAAe2Y,EAAQpS,KAAKvG,KAAM,YACtD2Y,EAAQpS,KAAKvG,KAAKgW,OAAS,YAA8BX,GACzDsD,EAAQpS,KAAKS,MAAQ,IAAU4D,UACQ,aAAhC+N,EAAQpS,KAAKvG,KAAKyG,YACzBkS,EAAQpS,KAAKS,MAAQ,IAAU4D,UAInC+N,EAAU,YAAaA,EAAQpS,KAAMqP,EAAIC,UAAU3O,UAAU,GAAO,GACpE,IAAM8R,IAAiBpD,EAAIC,UAAU3O,UAC/B0O,EAAIC,UAAU3O,SAASuO,+BAsB7B,OApBAkD,EAAU,EAAS9D,YAAY8D,EAAS/C,EAAIC,UAAU3O,UAAU,GAAO8R,IAC/DC,cAAe,EAGvBN,EAAQpS,KAAK3D,GAAK,KAIlB+V,EAAQhL,aAAc,EAGlBgL,EAAQpS,KAAKS,QAAU,IAAU4D,UACjC,YAAsBgL,EAAK,IAA0BsD,cAAe,CAChE/Z,KAAMyW,EAAI3V,QAAQD,KAAKb,KACvByD,GAAI+V,EAAQpS,KAAK3D,KAMlB,2BACAgT,EAAIC,WAAS,CAChBzF,QAAS,YAAIwF,EAAIC,UAAUzF,QAAS,CAAAuI,IACpCjF,UAAW,IAAQ+C,UAAUb,EAAIC,UAAUnC,UAAWkC,EAAIC,UAAUzF,SACpEE,gBAAgB,EAChBD,eAAe,IAGvB,OAAOuF,EAAIC,WChHZ,IAAMsD,KAAU,MAElB,IAAiB3Y,gBAAiB,IAAOD,cAC1C,EAAC,IAAiBG,kBAAmB,IAAOD,gBAC5C,EAAC,IAA0BuE,cAAe,IAAOD,aACjD,EAAC,IAAiBG,eAAgB,IAAOkU,iBACzC,EAAC,IAAiB/T,eAAgB,IAAcF,aAChD,EAAC,IAAiBtB,QAAS,IAASwV,YACpC,EAAC,IAAiBtV,oBAAqB,IAASuV,iBAChD,EAAC,IAAiBC,MAAO,IAASC,KAClC,EAAC,IAAiBrV,kBAAmB,IAASH,eAC9C,EAAC,IAAiBjD,aAAc,EAASF,WACzC,EAAC,IAA0BY,UAAW,IAASF,SAC/C,EAAC,IAAiBD,YAAa,IAASF,UACxC,EAAC,IAAiBS,WAAY,IAASD,SACvC,EAAC,IAAiBD,oBAAqB,EAAQD,iBAC/C,EAAC,IAAiBK,gBAAiB,IAASD,aAC5C,EAAC,IAAiBG,aAAc,IAASwX,OACzC,EAAC,IAAiBtX,uBAAwB,IAASuX,eACnD,EAAC,IAAiBlX,WAAY,IAASF,SACvC,EAAC,IAAiBW,cAAe,EAAUD,YAC3C,EAAC,IAA0BS,WAAY,EAAQD,UAC/C,EAAC,IAAiBa,eAAgB,IAASsV,QAC3C,EAAC,IAA0BC,cAAe,EAAS7G,OACnD,EAAC,IAAiBvO,QAAS,EAAQ2T,SACnC,EAAC,IAAiB9V,YAAa,EAAQD,UACvC,EAAC,IAAiBsC,cAAe,EAAQ0T,YACzC,EAAC,IAAiBtT,SAAU,EAASiS,QACrC,EAAC,IAAiBzW,aAAc,IAAcD,WAC9C,EAAC,IAAiBwZ,8BAA+B,IAAcC,gCAC/D,EAAC,IAAiBC,8BAA+B,IAAcC,gCAC/D,EAAC,IAAiBC,wCAAyC,IAAcC,qCACzE,EAAC,IAAiBjU,0BAA2B,IAAckU,6BAG3D,EAAC,IAA0BlZ,MAAO,EAAUD,KAC5C,EAAC,IAA0BG,MAAO,EAAUD,KAC5C,EAAC,IAA0BkZ,WAAY,EAASzE,UAChD,EAAC,IAA0B0E,YAAa,EAAS7D,WACjD,EAAC,IAA0B8D,gCAAiC,EAAS/D,WACrE,EAAC,IAA0BgE,UAAW,IAAcC,SACpD,EAAC,IAA0BC,eAAgB,IAAOC,gBAClD,EAAC,IAAYC,gBAAiB,IAAcC,UAC5C,EAAC,IAA0BC,aAAc,IAAczG,YACvD,EAAC,IAAY0G,wBAAyB,IAAcC,kBACpD,EAAC,IAA0BC,aAAc,IAASC,YAClD,EAAC,IAA0BxX,WAAY,EAAQD,UAC/C,EAAC,IAA0BG,aAAc,EAAQD,YACjD,EAAC,IAA0B9C,gBAAiB,EAASD,eACrD,EAAC,IAA0Bua,eAAgB,IAAcC,cACzD,EAAC,IAA0BC,cAAe,IAAcC,aACxD,EAAC,IAAeC,gBAAiB,EAAQjE,eACzC,EAAC,IAA0BkE,gBAAiB,EAAUhD,eACtD,EAAC,IAA0BiD,eAAgB,EAAUhD,cACrD,EAAC,IAA0BiD,cAAe,EAAQvD,aAClD,EAAC,IAA0BwD,cAAe,IAAOC,aACjD,EAAC,IAAeC,SAAU,IAAcC,cACxC,EAAC,IAA0BC,mBAAoB,IAAcC,wBAC7D,EAAC,IAA0BC,SAAU,IAASC,QAC9C,EAAC,IAA0BC,WAAY,IAAS7U,U,GCnDpD,ICd4B6J,GAAsBpK,GAAmB2C,GAAmB0S,GDclF,GAAY,cAEZ,GAAYC,OAAeC,WAE3B,IAAc,IAA+C,oBAArBC,iBAGxC,GAAa,IAAI,IACjB,ICtBsBpL,GDsBF,GCtBwBpK,GDsBX,GCtB8B2C,GDsBnB,GCtBsC0S,GDsB5B,GCrBjD,IAAwBjL,GAAapK,GAAW2C,IAAU,GAAO,EAAO0P,GAAYgD,KDwBzFI,GLgZK,YAAQjN,EAAiBlP,EAAzB,CAAyC,GK5YpD,SACI,gBAAC,IAAQ,CAACoc,MAAO,IACb,gBAACD,GAA0B,MAC3B,gBAAC,IAAsB,CAACJ,WAAY,GAAYM,kBAAmB,aAAcD,MAAO,MAE5F1Q,SAAS4Q,eAAe,U,qBE1C5B,IAAIjO,EAAU,EAAQ,QAEA,iBAAZA,IAAsBA,EAAU,CAAC,CAACpS,EAAON,EAAI0S,EAAS,MAOhE,IAAIoD,EAAU,CAAC,KAAM,EAErB,eAPI8K,EAQJ,gBAAqBvd,GAER,EAAQ,OAAR,CAAgEqP,EAASoD,GAEnFpD,EAAQmO,SAAQvgB,EAAOsB,QAAU8Q,EAAQmO,S,mBCjB5CvgB,EAAOsB,QAAUkf","file":"interactiveWindow.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"interactiveWindow\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + ({\"vendors~dataresource~geojson~modeldebug~nteract_transforms~nteract_transforms_vsdom\":\"vendors~dataresource~geojson~modeldebug~nteract_transforms~nteract_transforms_vsdom\",\"modeldebug\":\"modeldebug\",\"nteract_transforms_vsdom\":\"nteract_transforms_vsdom\",\"vendors~dataresource~vega\":\"vendors~dataresource~vega\",\"vendors~dataresource\":\"vendors~dataresource\",\"vendors~geojson\":\"vendors~geojson\",\"vendors~nteract_transforms\":\"vendors~nteract_transforms\",\"vendors~vega\":\"vendors~vega\",\"vega\":\"vega\",\"vendors~plotly\":\"vendors~plotly\"}[chunkId]||chunkId) + \".bundle.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\t(function (module) {\n \t\t  if (module.exports\n \t\t    && !module.exports.__esModule\n \t\t    && module.exports.default === undefined\n \t\t  ) {\n \t\t    if (module.exports.headers\n \t\t      && module.exports.headers.common\n \t\t      && module.exports.headers.common.Accept\n \t\t      && module.exports.adapter\n \t\t      && module.exports.transformRequest\n \t\t      && module.exports.transformResponse\n \t\t    ) {\n \t\t      return;\n \t\t    }\n \t\t    module.exports.default = module.exports;\n \t\t  }\n \t\t})(module);\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([7,\"monaco\",\"commons\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\nexports.i(require(\"-!../../../node_modules/css-loader/index.js!../interactive-common/common.css\"), \"\");\n\n// module\nexports.push([module.id, \"/* Import common styles and then override them below */\\n.toolbar-menu-bar-child {\\n  background: var(--override-background, var(--vscode-editor-background));\\n  z-index: 10;\\n}\\n#main-panel-content {\\n  grid-area: content;\\n  max-height: 100%;\\n  overflow-x: hidden;\\n  overflow-y: auto;\\n}\\n.messages-result-container {\\n  width: 100%;\\n}\\n.messages-result-container pre {\\n  white-space: pre-wrap;\\n  font-family: monospace;\\n  margin: 0px;\\n  word-break: break-all;\\n}\\n.cell-wrapper {\\n  margin: 0px;\\n  padding: 0px;\\n  display: block;\\n}\\n.cell-result-container {\\n  margin: 0px;\\n  display: grid;\\n  grid-auto-columns: minmax(0, 1fr);\\n}\\n.cell-outer {\\n  display: grid;\\n  grid-template-columns: auto minmax(0, 1fr) 8px;\\n  grid-column-gap: 3px;\\n  width: 100%;\\n}\\n.cell-output {\\n  margin: 0px;\\n  width: 100%;\\n  overflow-x: scroll;\\n  background: transparent;\\n}\\n.cell-output > div {\\n  background: var(--override-widget-background, var(--vscode-notifications-background));\\n}\\nxmp {\\n  margin: 0px;\\n}\\n.cell-input {\\n  margin: 0;\\n}\\n.markdown-cell-output {\\n  width: 100%;\\n  overflow-x: scroll;\\n}\\n.cell-output-text {\\n  white-space: pre-wrap;\\n  word-break: break-all;\\n  overflow-x: hidden;\\n}\\n\", \"\"]);\n\n// exports\n","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n'use strict';\n\nimport * as React from 'react';\nimport { getLocString } from '../react-common/locReactSide';\n\ninterface ICollapseButtonProps {\n    theme: string;\n    tooltip: string;\n    visible: boolean;\n    open: boolean;\n    label?: string;\n    onClick(): void;\n}\n\nexport class CollapseButton extends React.Component<ICollapseButtonProps> {\n    constructor(props: ICollapseButtonProps) {\n        super(props);\n    }\n\n    public render() {\n        const collapseInputPolygonClassNames = `collapse-input-svg ${\n            this.props.open ? ' collapse-input-svg-rotate' : ''\n        } collapse-input-svg-${this.props.theme}`;\n        const collapseInputClassNames = `collapse-input remove-style ${this.props.visible ? '' : ' invisible'}`;\n        const tooltip = this.props.open\n            ? getLocString('DataScience.collapseSingle', 'Collapse')\n            : getLocString('DataScience.expandSingle', 'Expand');\n        const ariaExpanded = this.props.open ? 'true' : 'false';\n        // https://reactjs.org/docs/conditional-rendering.html#inline-if-with-logical--operator\n        // Comment here just because the (boolean && statement) was new to me\n        return (\n            <button\n                className={collapseInputClassNames}\n                title={tooltip}\n                onClick={this.props.onClick}\n                aria-expanded={ariaExpanded}\n            >\n                <svg version=\"1.1\" baseProfile=\"full\" width=\"8px\" height=\"11px\">\n                    <polygon points=\"0,0 0,10 5,5\" className={collapseInputPolygonClassNames} fill=\"black\" />\n                </svg>\n                {this.props.label && <label className=\"collapseInputLabel\">{this.props.label}</label>}\n            </button>\n        );\n    }\n}\n","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n'use strict';\n\nexport class InputHistory {\n    private historyStack: string[] = [];\n    private up: number | undefined;\n    private down: number | undefined;\n    private last: number | undefined;\n\n    public completeUp(code: string): string {\n        // If going up, only move if anything in the history\n        if (this.historyStack.length > 0) {\n            if (this.up === undefined) {\n                this.up = 0;\n            }\n\n            const result = this.up < this.historyStack.length ? this.historyStack[this.up] : code;\n            this.adjustCursors(this.up);\n            return result;\n        }\n\n        return code;\n    }\n\n    public completeDown(code: string): string {\n        // If going down, move and then return something if we have a position\n        if (this.historyStack.length > 0 && this.down !== undefined) {\n            const result = this.historyStack[this.down];\n            this.adjustCursors(this.down);\n            return result;\n        }\n\n        return code;\n    }\n\n    public add(code: string, typed: boolean) {\n        // Compute our new history. Behavior depends upon if the user typed it in or\n        // just used the arrows\n\n        // Only skip adding a dupe if it's the same as the top item. Otherwise\n        // add it as normal.\n        this.historyStack =\n            this.last === 0 && this.historyStack.length > 0 && this.historyStack[this.last] === code\n                ? this.historyStack\n                : [code, ...this.historyStack];\n\n        // Position is more complicated. If we typed something start over\n        if (typed) {\n            this.reset();\n        } else {\n            // We want our next up push to match the index of the item that was\n            // actually entered.\n            if (this.last === 0) {\n                this.up = undefined;\n                this.down = undefined;\n            } else if (this.last) {\n                this.up = this.last + 1;\n                this.down = this.last - 1;\n            }\n        }\n    }\n\n    private reset() {\n        this.up = undefined;\n        this.down = undefined;\n    }\n\n    private adjustCursors(currentPos: number) {\n        // Save last position we entered.\n        this.last = currentPos;\n\n        // For a single item, ony up works. But never modify it.\n        if (this.historyStack.length > 1) {\n            if (currentPos < this.historyStack.length) {\n                this.up = currentPos + 1;\n            } else {\n                this.up = this.historyStack.length;\n\n                // If we go off the end, don't make the down go up to the last.\n                // CMD prompt behaves this way. Down is always one off.\n                currentPos = this.historyStack.length - 1;\n            }\n            if (currentPos > 0) {\n                this.down = currentPos - 1;\n            } else {\n                this.down = undefined;\n            }\n        }\n    }\n}\n","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n'use strict';\n\nimport {\n    IInteractiveWindowMapping,\n    InteractiveWindowMessages\n} from '../../../client/datascience/interactive-common/interactiveWindowTypes';\nimport { IJupyterVariable, IJupyterVariablesRequest } from '../../../client/datascience/types';\nimport {\n    CommonAction,\n    CommonActionType,\n    CommonActionTypeMapping,\n    ICellAction,\n    ICodeAction,\n    ICodeCreatedAction,\n    IEditCellAction,\n    ILinkClickAction,\n    IOpenSettingsAction,\n    IScrollAction,\n    IShowDataViewerAction,\n    IVariableExplorerHeight\n} from '../../interactive-common/redux/reducers/types';\nimport { IMonacoModelContentChangeEvent } from '../../react-common/monacoHelpers';\n\n// This function isn't made common and not exported, to ensure it isn't used elsewhere.\nfunction createIncomingActionWithPayload<\n    M extends IInteractiveWindowMapping & CommonActionTypeMapping,\n    K extends keyof M\n>(type: K, data: M[K]): CommonAction<M[K]> {\n    // tslint:disable-next-line: no-any\n    return { type, payload: { data, messageDirection: 'incoming' } as any } as any;\n}\n// This function isn't made common and not exported, to ensure it isn't used elsewhere.\nfunction createIncomingAction(type: CommonActionType | InteractiveWindowMessages): CommonAction {\n    return { type, payload: { messageDirection: 'incoming', data: undefined } };\n}\n\n// See https://react-redux.js.org/using-react-redux/connect-mapdispatch#defining-mapdispatchtoprops-as-an-object\nexport const actionCreators = {\n    focusInput: (): CommonAction => createIncomingAction(CommonActionType.FOCUS_INPUT),\n    restartKernel: (): CommonAction => createIncomingAction(CommonActionType.RESTART_KERNEL),\n    interruptKernel: (): CommonAction => createIncomingAction(CommonActionType.INTERRUPT_KERNEL),\n    deleteAllCells: (): CommonAction => createIncomingAction(InteractiveWindowMessages.DeleteAllCells),\n    deleteCell: (cellId: string): CommonAction<ICellAction> =>\n        createIncomingActionWithPayload(CommonActionType.DELETE_CELL, { cellId }),\n    undo: (): CommonAction => createIncomingAction(InteractiveWindowMessages.Undo),\n    redo: (): CommonAction => createIncomingAction(InteractiveWindowMessages.Redo),\n    linkClick: (href: string): CommonAction<ILinkClickAction> =>\n        createIncomingActionWithPayload(CommonActionType.LINK_CLICK, { href }),\n    showPlot: (imageHtml: string) => createIncomingActionWithPayload(InteractiveWindowMessages.ShowPlot, imageHtml),\n    toggleInputBlock: (cellId: string): CommonAction<ICellAction> =>\n        createIncomingActionWithPayload(CommonActionType.TOGGLE_INPUT_BLOCK, { cellId }),\n    gotoCell: (cellId: string): CommonAction<ICellAction> =>\n        createIncomingActionWithPayload(CommonActionType.GOTO_CELL, { cellId }),\n    copyCellCode: (cellId: string): CommonAction<ICellAction> =>\n        createIncomingActionWithPayload(CommonActionType.COPY_CELL_CODE, { cellId }),\n    gatherCell: (cellId: string): CommonAction<ICellAction> =>\n        createIncomingActionWithPayload(CommonActionType.GATHER_CELL, { cellId }),\n    gatherCellToScript: (cellId: string): CommonAction<ICellAction> =>\n        createIncomingActionWithPayload(CommonActionType.GATHER_CELL_TO_SCRIPT, { cellId }),\n    clickCell: (cellId: string): CommonAction<ICellAction> =>\n        createIncomingActionWithPayload(CommonActionType.CLICK_CELL, { cellId }),\n    editCell: (cellId: string, e: IMonacoModelContentChangeEvent): CommonAction<IEditCellAction> =>\n        createIncomingActionWithPayload(CommonActionType.EDIT_CELL, {\n            cellId,\n            version: e.versionId,\n            modelId: e.model.id,\n            forward: e.forward,\n            reverse: e.reverse,\n            id: cellId,\n            code: e.model.getValue()\n        }),\n    submitInput: (code: string, cellId: string): CommonAction<ICodeAction> =>\n        createIncomingActionWithPayload(CommonActionType.SUBMIT_INPUT, { code, cellId }),\n    toggleVariableExplorer: (): CommonAction => createIncomingAction(CommonActionType.TOGGLE_VARIABLE_EXPLORER),\n    setVariableExplorerHeight: (containerHeight: number, gridHeight: number): CommonAction<IVariableExplorerHeight> =>\n        createIncomingActionWithPayload(CommonActionType.SET_VARIABLE_EXPLORER_HEIGHT, { containerHeight, gridHeight }),\n    expandAll: (): CommonAction => createIncomingAction(InteractiveWindowMessages.ExpandAll),\n    collapseAll: (): CommonAction => createIncomingAction(InteractiveWindowMessages.CollapseAll),\n    export: (): CommonAction => createIncomingAction(CommonActionType.EXPORT),\n    exportAs: (): CommonAction => createIncomingAction(CommonActionType.EXPORT_NOTEBOOK_AS),\n    showDataViewer: (variable: IJupyterVariable, columnSize: number): CommonAction<IShowDataViewerAction> =>\n        createIncomingActionWithPayload(CommonActionType.SHOW_DATA_VIEWER, { variable, columnSize }),\n    editorLoaded: (): CommonAction => createIncomingAction(CommonActionType.EDITOR_LOADED),\n    scroll: (isAtBottom: boolean): CommonAction<IScrollAction> =>\n        createIncomingActionWithPayload(CommonActionType.SCROLL, { isAtBottom }),\n    unfocus: (cellId: string | undefined): CommonAction<ICellAction> =>\n        createIncomingActionWithPayload(CommonActionType.UNFOCUS_CELL, { cellId }),\n    codeCreated: (cellId: string | undefined, modelId: string): CommonAction<ICodeCreatedAction> =>\n        createIncomingActionWithPayload(CommonActionType.CODE_CREATED, { cellId, modelId }),\n    editorUnmounted: (): CommonAction => createIncomingAction(CommonActionType.UNMOUNT),\n    selectKernel: (): CommonAction => createIncomingAction(InteractiveWindowMessages.SelectKernel),\n    selectServer: (): CommonAction => createIncomingAction(CommonActionType.SELECT_SERVER),\n    openSettings: (setting?: string): CommonAction<IOpenSettingsAction> =>\n        createIncomingActionWithPayload(CommonActionType.OPEN_SETTINGS, { setting }),\n    getVariableData: (\n        newExecutionCount: number,\n        refreshCount: number,\n        startIndex: number = 0,\n        pageSize: number = 100\n    ): CommonAction<IJupyterVariablesRequest> =>\n        createIncomingActionWithPayload(CommonActionType.GET_VARIABLE_DATA, {\n            executionCount: newExecutionCount,\n            sortColumn: 'name',\n            sortAscending: true,\n            startIndex,\n            pageSize,\n            refreshCount\n        }),\n    widgetFailed: (ex: Error): CommonAction<Error> =>\n        createIncomingActionWithPayload(CommonActionType.IPYWIDGET_RENDER_FAILURE, ex)\n};\n","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n'use strict';\nimport '../../client/common/extensions';\n\nimport { nbformat } from '@jupyterlab/coreutils';\nimport * as fastDeepEqual from 'fast-deep-equal';\nimport * as monacoEditor from 'monaco-editor/esm/vs/editor/editor.api';\nimport * as React from 'react';\nimport { connect } from 'react-redux';\n\nimport { Identifiers } from '../../client/datascience/constants';\nimport { CellState, IDataScienceExtraSettings } from '../../client/datascience/types';\nimport { CellInput } from '../interactive-common/cellInput';\nimport { CellOutput } from '../interactive-common/cellOutput';\nimport { CollapseButton } from '../interactive-common/collapseButton';\nimport { ExecutionCount } from '../interactive-common/executionCount';\nimport { InformationMessages } from '../interactive-common/informationMessages';\nimport { InputHistory } from '../interactive-common/inputHistory';\nimport { ICellViewModel, IFont } from '../interactive-common/mainState';\nimport { IKeyboardEvent } from '../react-common/event';\nimport { Image, ImageName } from '../react-common/image';\nimport { ImageButton } from '../react-common/imageButton';\nimport { getLocString } from '../react-common/locReactSide';\nimport { IMonacoModelContentChangeEvent } from '../react-common/monacoHelpers';\nimport { actionCreators } from './redux/actions';\n\ninterface IInteractiveCellBaseProps {\n    role?: string;\n    cellVM: ICellViewModel;\n    language: string;\n    baseTheme: string;\n    codeTheme: string;\n    testMode?: boolean;\n    autoFocus: boolean;\n    maxTextSize?: number;\n    enableScroll?: boolean;\n    showWatermark: boolean;\n    monacoTheme: string | undefined;\n    editorOptions?: monacoEditor.editor.IEditorOptions;\n    editExecutionCount?: string;\n    editorMeasureClassName?: string;\n    font: IFont;\n    settings: IDataScienceExtraSettings;\n    focusPending: number;\n}\n\ntype IInteractiveCellProps = IInteractiveCellBaseProps & typeof actionCreators;\n\n// tslint:disable: react-this-binding-issue\nexport class InteractiveCell extends React.Component<IInteractiveCellProps> {\n    private codeRef: React.RefObject<CellInput> = React.createRef<CellInput>();\n    private wrapperRef: React.RefObject<HTMLDivElement> = React.createRef<HTMLDivElement>();\n    private inputHistory: InputHistory | undefined;\n\n    constructor(prop: IInteractiveCellProps) {\n        super(prop);\n        this.state = { showingMarkdownEditor: false };\n        if (prop.cellVM.cell.id === Identifiers.EditCellId) {\n            this.inputHistory = new InputHistory();\n        }\n    }\n\n    public render() {\n        if (this.props.cellVM.cell.data.cell_type === 'messages') {\n            return <InformationMessages messages={this.props.cellVM.cell.data.messages} />;\n        } else {\n            return this.renderNormalCell();\n        }\n    }\n\n    public componentDidUpdate(prevProps: IInteractiveCellProps) {\n        if (this.props.cellVM.selected && !prevProps.cellVM.selected && !this.props.cellVM.focused) {\n            this.giveFocus();\n        }\n        if (this.props.cellVM.scrollCount !== prevProps.cellVM.scrollCount) {\n            this.scrollAndFlash();\n        }\n    }\n\n    public shouldComponentUpdate(nextProps: IInteractiveCellProps): boolean {\n        return !fastDeepEqual(this.props, nextProps);\n    }\n\n    private scrollAndFlash() {\n        if (this.wrapperRef && this.wrapperRef.current) {\n            // tslint:disable-next-line: no-any\n            if ((this.wrapperRef.current as any).scrollIntoView) {\n                this.wrapperRef.current.scrollIntoView({ behavior: 'auto', block: 'nearest', inline: 'nearest' });\n            }\n            this.wrapperRef.current.classList.add('flash');\n            setTimeout(() => {\n                if (this.wrapperRef.current) {\n                    this.wrapperRef.current.classList.remove('flash');\n                }\n            }, 1000);\n        }\n    }\n\n    private giveFocus() {\n        // Start out with ourselves\n        if (this.wrapperRef && this.wrapperRef.current) {\n            // Give focus to the cell if not already owning focus\n            if (!this.wrapperRef.current.contains(document.activeElement)) {\n                this.wrapperRef.current.focus();\n            }\n\n            // Scroll into view (since we have focus). However this function\n            // is not supported on enzyme\n            // tslint:disable-next-line: no-any\n            if ((this.wrapperRef.current as any).scrollIntoView) {\n                this.wrapperRef.current.scrollIntoView({ behavior: 'auto', block: 'nearest', inline: 'nearest' });\n            }\n        }\n    }\n\n    private toggleInputBlock = () => {\n        const cellId: string = this.getCell().id;\n        this.props.toggleInputBlock(cellId);\n    };\n\n    private getCell = () => {\n        return this.props.cellVM.cell;\n    };\n\n    private isCodeCell = () => {\n        return this.props.cellVM.cell.data.cell_type === 'code';\n    };\n\n    private renderNormalCell() {\n        const allowsPlainInput =\n            this.props.settings.showCellInputCode || this.props.cellVM.directInput || this.props.cellVM.editable;\n        const shouldRender = allowsPlainInput || this.shouldRenderResults();\n        const cellOuterClass = this.props.cellVM.editable ? 'cell-outer-editable' : 'cell-outer';\n        const cellWrapperClass = this.props.cellVM.editable ? 'cell-wrapper' : 'cell-wrapper cell-wrapper-noneditable';\n        const themeMatplotlibPlots = this.props.settings.themeMatplotlibPlots ? true : false;\n        // Only render if we are allowed to.\n        if (shouldRender) {\n            return (\n                <div\n                    className={cellWrapperClass}\n                    role={this.props.role}\n                    ref={this.wrapperRef}\n                    tabIndex={0}\n                    onKeyDown={this.onKeyDown}\n                    onKeyUp={this.onKeyUp}\n                    onClick={this.onMouseClick}\n                >\n                    <div className={cellOuterClass}>\n                        {this.renderControls()}\n                        <div className=\"content-div\">\n                            <div className=\"cell-result-container\">\n                                {this.renderInput()}\n                                <div>\n                                    <CellOutput\n                                        cellVM={this.props.cellVM}\n                                        baseTheme={this.props.baseTheme}\n                                        expandImage={this.props.showPlot}\n                                        maxTextSize={this.props.maxTextSize}\n                                        enableScroll={this.props.enableScroll}\n                                        themeMatplotlibPlots={themeMatplotlibPlots}\n                                        widgetFailed={this.props.widgetFailed}\n                                        openSettings={this.props.openSettings}\n                                    />\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            );\n        }\n\n        // Shouldn't be rendered because not allowing empty input and not a direct input cell\n        return null;\n    }\n\n    private renderNormalToolbar = () => {\n        const cell = this.getCell();\n        const cellId = cell.id;\n        const gotoCode = () => this.props.gotoCell(cellId);\n        const deleteCode = () => this.props.deleteCell(cellId);\n        const copyCode = () => this.props.copyCellCode(cellId);\n        const gatherCode = () => this.props.gatherCellToScript(cellId);\n        const hasNoSource = !cell || !cell.file || cell.file === Identifiers.EmptyFileName;\n\n        return (\n            <div className=\"cell-toolbar\" key={0}>\n                <ImageButton\n                    baseTheme={this.props.baseTheme}\n                    onClick={gatherCode}\n                    hidden={\n                        this.props.cellVM.cell.state === CellState.error ||\n                        this.props.cellVM.cell.state === CellState.executing ||\n                        this.props.cellVM.cell.data.cell_type === 'markdown' ||\n                        !this.props.settings.gatherIsInstalled\n                    }\n                    tooltip={getLocString('DataScience.gatherCodeTooltip', 'Gather code')}\n                    disabled={this.props.cellVM.gathering}\n                >\n                    <Image\n                        baseTheme={this.props.baseTheme}\n                        class=\"image-button-image\"\n                        image={this.props.cellVM.gathering ? ImageName.Sync : ImageName.GatherCode}\n                    />\n                </ImageButton>\n                <ImageButton\n                    baseTheme={this.props.baseTheme}\n                    onClick={gotoCode}\n                    tooltip={getLocString('DataScience.gotoCodeButtonTooltip', 'Go to code')}\n                    hidden={hasNoSource}\n                >\n                    <Image\n                        baseTheme={this.props.baseTheme}\n                        class=\"image-button-image\"\n                        image={ImageName.GoToSourceCode}\n                    />\n                </ImageButton>\n                <ImageButton\n                    baseTheme={this.props.baseTheme}\n                    onClick={copyCode}\n                    tooltip={getLocString('DataScience.copyBackToSourceButtonTooltip', 'Paste code into file')}\n                    hidden={!hasNoSource}\n                >\n                    <Image baseTheme={this.props.baseTheme} class=\"image-button-image\" image={ImageName.Copy} />\n                </ImageButton>\n                <ImageButton\n                    baseTheme={this.props.baseTheme}\n                    onClick={deleteCode}\n                    tooltip={getLocString('DataScience.deleteButtonTooltip', 'Remove Cell')}\n                >\n                    <Image baseTheme={this.props.baseTheme} class=\"image-button-image\" image={ImageName.Cancel} />\n                </ImageButton>\n            </div>\n        );\n    };\n\n    private onMouseClick = (ev: React.MouseEvent<HTMLDivElement>) => {\n        // When we receive a click, propagate upwards. Might change our state\n        ev.stopPropagation();\n        this.props.clickCell(this.props.cellVM.cell.id);\n    };\n\n    private renderControls = () => {\n        const busy =\n            this.props.cellVM.cell.state === CellState.init || this.props.cellVM.cell.state === CellState.executing;\n        const collapseVisible =\n            this.props.cellVM.inputBlockCollapseNeeded &&\n            this.props.cellVM.inputBlockShow &&\n            !this.props.cellVM.editable &&\n            this.isCodeCell();\n        const executionCount =\n            this.props.cellVM &&\n            this.props.cellVM.cell &&\n            this.props.cellVM.cell.data &&\n            this.props.cellVM.cell.data.execution_count\n                ? this.props.cellVM.cell.data.execution_count.toString()\n                : '-';\n        const isEditOnlyCell = this.props.cellVM.cell.id === Identifiers.EditCellId;\n        const toolbar = isEditOnlyCell ? null : this.renderNormalToolbar();\n\n        return (\n            <div className=\"controls-div\">\n                <ExecutionCount\n                    isBusy={busy}\n                    count={\n                        isEditOnlyCell && this.props.editExecutionCount ? this.props.editExecutionCount : executionCount\n                    }\n                    visible={this.isCodeCell()}\n                />\n                <CollapseButton\n                    theme={this.props.baseTheme}\n                    visible={collapseVisible}\n                    open={this.props.cellVM.inputBlockOpen}\n                    onClick={this.toggleInputBlock}\n                    tooltip={getLocString('DataScience.collapseInputTooltip', 'Collapse input block')}\n                />\n                {toolbar}\n            </div>\n        );\n    };\n\n    private renderInput = () => {\n        if (this.isCodeCell()) {\n            return (\n                <CellInput\n                    cellVM={this.props.cellVM}\n                    editorOptions={this.props.editorOptions}\n                    history={this.inputHistory}\n                    codeTheme={this.props.codeTheme}\n                    onCodeChange={this.onCodeChange}\n                    onCodeCreated={this.onCodeCreated}\n                    unfocused={this.onUnfocused}\n                    testMode={this.props.testMode ? true : false}\n                    showWatermark={this.props.showWatermark}\n                    ref={this.codeRef}\n                    monacoTheme={this.props.monacoTheme}\n                    openLink={this.openLink}\n                    editorMeasureClassName={this.props.editorMeasureClassName}\n                    keyDown={this.isEditCell() ? this.onEditCellKeyDown : undefined}\n                    showLineNumbers={this.props.cellVM.showLineNumbers}\n                    font={this.props.font}\n                    disableUndoStack={this.props.cellVM.cell.id !== Identifiers.EditCellId}\n                    codeVersion={this.props.cellVM.codeVersion ? this.props.cellVM.codeVersion : 0}\n                    focusPending={this.props.focusPending}\n                    language={this.props.language}\n                    isNotebookTrusted={true}\n                />\n            );\n        }\n        return null;\n    };\n\n    private isEditCell(): boolean {\n        return this.getCell().id === Identifiers.EditCellId;\n    }\n\n    private onUnfocused = () => {\n        this.props.unfocus(this.getCell().id);\n    };\n\n    private onCodeChange = (e: IMonacoModelContentChangeEvent) => {\n        this.props.editCell(this.getCell().id, e);\n    };\n\n    private onCodeCreated = (_code: string, _file: string, cellId: string, modelId: string) => {\n        this.props.codeCreated(cellId, modelId);\n    };\n\n    private hasOutput = () => {\n        return (\n            this.getCell().state === CellState.finished ||\n            this.getCell().state === CellState.error ||\n            this.getCell().state === CellState.executing\n        );\n    };\n\n    private getCodeCell = () => {\n        return this.props.cellVM.cell.data as nbformat.ICodeCell;\n    };\n\n    private shouldRenderResults(): boolean {\n        return (\n            this.isCodeCell() &&\n            this.hasOutput() &&\n            this.getCodeCell().outputs &&\n            this.getCodeCell().outputs.length > 0 &&\n            !this.props.cellVM.hideOutput\n        );\n    }\n\n    private onKeyDown = (event: React.KeyboardEvent<HTMLDivElement>) => {\n        // Handle keydown events for the entire cell\n        if (this.getCell().id === Identifiers.EditCellId) {\n            const e: IKeyboardEvent = {\n                code: event.key,\n                shiftKey: event.shiftKey,\n                ctrlKey: event.ctrlKey,\n                metaKey: event.metaKey,\n                altKey: event.altKey,\n                target: event.target as HTMLDivElement,\n                stopPropagation: () => event.stopPropagation(),\n                preventDefault: () => event.preventDefault()\n            };\n            this.onEditCellKeyDown(Identifiers.EditCellId, e);\n        }\n    };\n\n    private onKeyUp = (event: React.KeyboardEvent<HTMLDivElement>) => {\n        // Handle keydown events for the entire cell\n        if (this.getCell().id === Identifiers.EditCellId) {\n            const e: IKeyboardEvent = {\n                code: event.key,\n                shiftKey: event.shiftKey,\n                ctrlKey: event.ctrlKey,\n                metaKey: event.metaKey,\n                altKey: event.altKey,\n                target: event.target as HTMLDivElement,\n                stopPropagation: () => event.stopPropagation(),\n                preventDefault: () => event.preventDefault()\n            };\n            this.onEditCellKeyUp(Identifiers.EditCellId, e);\n        }\n    };\n\n    private onEditCellKeyDown = (_cellId: string, e: IKeyboardEvent) => {\n        if (e.code === 'Enter' && e.shiftKey) {\n            this.editCellSubmit(e);\n        } else if (e.code === 'NumpadEnter' && e.shiftKey) {\n            this.editCellSubmit(e);\n        } else if (e.code === 'KeyU' && e.ctrlKey && e.editorInfo && !e.editorInfo.isSuggesting) {\n            e.editorInfo.clear();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (e.code === 'Escape' && !e.shiftKey && e.editorInfo && !e.editorInfo.isSuggesting) {\n            e.editorInfo.clear();\n            e.stopPropagation();\n            e.preventDefault();\n        }\n    };\n\n    private onEditCellKeyUp = (_cellId: string, e: IKeyboardEvent) => {\n        // Special case. Escape + Shift only comes as a key up because shift comes as the\n        // key down.\n        if (e.code === 'Escape' && e.shiftKey) {\n            this.editCellShiftEscape(e);\n        }\n    };\n\n    private editCellSubmit(e: IKeyboardEvent) {\n        if (e.editorInfo && e.editorInfo.contents) {\n            // Prevent shift+enter from turning into a enter\n            e.stopPropagation();\n            e.preventDefault();\n\n            // Remove empty lines off the end\n            let endPos = e.editorInfo.contents.length - 1;\n            while (endPos >= 0 && e.editorInfo.contents[endPos] === '\\n') {\n                endPos -= 1;\n            }\n            const content = e.editorInfo.contents.slice(0, endPos + 1);\n\n            // Send to the input history too if necessary\n            if (this.inputHistory) {\n                this.inputHistory.add(content, e.editorInfo.isDirty);\n            }\n\n            // Clear our editor\n            e.editorInfo.clear();\n\n            // Send to jupyter\n            this.props.submitInput(content, this.props.cellVM.cell.id);\n        }\n    }\n\n    private findTabStop(direction: number, element: Element): HTMLElement | undefined {\n        if (element) {\n            const allFocusable = document.querySelectorAll('input, button, select, textarea, a[href]');\n            if (allFocusable) {\n                const tabable = Array.prototype.filter.call(allFocusable, (i: HTMLElement) => i.tabIndex >= 0);\n                const self = tabable.indexOf(element);\n                return direction >= 0 ? tabable[self + 1] || tabable[0] : tabable[self - 1] || tabable[0];\n            }\n        }\n    }\n\n    private editCellShiftEscape = (e: IKeyboardEvent) => {\n        const focusedElement = document.activeElement;\n        if (focusedElement !== null) {\n            const nextTabStop = this.findTabStop(1, focusedElement);\n            if (nextTabStop) {\n                e.stopPropagation();\n                e.preventDefault();\n                nextTabStop.focus();\n            }\n        }\n    };\n\n    private openLink = (uri: monacoEditor.Uri) => {\n        this.props.linkClick(uri.toString());\n    };\n}\n\n// Main export, return a redux connected editor\nexport const InteractiveCellComponent = connect(null, actionCreators)(InteractiveCell);\n","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { Identifiers } from '../../client/datascience/constants';\nimport { buildSettingsCss } from '../interactive-common/buildSettingsCss';\nimport { ContentPanel, IContentPanelProps } from '../interactive-common/contentPanel';\nimport { handleLinkClick } from '../interactive-common/handlers';\nimport { JupyterInfo } from '../interactive-common/jupyterInfo';\nimport { ICellViewModel } from '../interactive-common/mainState';\nimport { IMainWithVariables, IStore } from '../interactive-common/redux/store';\nimport { IVariablePanelProps, VariablePanel } from '../interactive-common/variablePanel';\nimport { ErrorBoundary } from '../react-common/errorBoundary';\nimport { Image, ImageName } from '../react-common/image';\nimport { ImageButton } from '../react-common/imageButton';\nimport { getLocString } from '../react-common/locReactSide';\nimport { Progress } from '../react-common/progress';\nimport { InteractiveCellComponent } from './interactiveCell';\nimport './interactivePanel.less';\nimport { actionCreators } from './redux/actions';\n\n// tslint:disable: no-suspicious-comment\n\nexport type IInteractivePanelProps = IMainWithVariables & typeof actionCreators;\n\nfunction mapStateToProps(state: IStore): IMainWithVariables {\n    return { ...state.main, variableState: state.variables };\n}\n\nexport class InteractivePanel extends React.Component<IInteractivePanelProps> {\n    private mainPanelRef: React.RefObject<HTMLDivElement> = React.createRef<HTMLDivElement>();\n    private mainPanelToolbarRef: React.RefObject<HTMLDivElement> = React.createRef<HTMLDivElement>();\n    private contentPanelRef: React.RefObject<ContentPanel> = React.createRef<ContentPanel>();\n    private renderCount: number = 0;\n    private internalScrollCount: number = 0;\n\n    constructor(props: IInteractivePanelProps) {\n        super(props);\n    }\n\n    public componentDidMount() {\n        document.addEventListener('click', this.linkClick, true);\n        this.props.editorLoaded();\n    }\n\n    public componentWillUnmount() {\n        document.removeEventListener('click', this.linkClick);\n        this.props.editorUnmounted();\n    }\n\n    public render() {\n        const dynamicFont: React.CSSProperties = {\n            fontSize: this.props.font.size,\n            fontFamily: this.props.font.family\n        };\n\n        const progressBar = (this.props.busy || !this.props.loaded) && !this.props.testMode ? <Progress /> : undefined;\n\n        // If in test mode, update our count. Use this to determine how many renders a normal update takes.\n        if (this.props.testMode) {\n            this.renderCount = this.renderCount + 1;\n        }\n\n        return (\n            <div id=\"main-panel\" ref={this.mainPanelRef} role=\"Main\" style={dynamicFont}>\n                <div className=\"styleSetter\">\n                    <style>{`${this.props.rootCss ? this.props.rootCss : ''}\n${buildSettingsCss(this.props.settings)}`}</style>\n                </div>\n                <header id=\"main-panel-toolbar\" ref={this.mainPanelToolbarRef}>\n                    {this.renderToolbarPanel()}\n                    {progressBar}\n                </header>\n                <section\n                    id=\"main-panel-variable\"\n                    aria-label={getLocString('DataScience.collapseVariableExplorerLabel', 'Variables')}\n                >\n                    {this.renderVariablePanel(this.props.baseTheme)}\n                </section>\n                <main id=\"main-panel-content\" onScroll={this.handleScroll}>\n                    {this.renderContentPanel(this.props.baseTheme)}\n                </main>\n                <section\n                    id=\"main-panel-footer\"\n                    onClick={this.footerPanelClick}\n                    aria-label={getLocString('DataScience.editSection', 'Input new cells here')}\n                >\n                    {this.renderFooterPanel(this.props.baseTheme)}\n                </section>\n            </div>\n        );\n    }\n\n    // Make the entire footer focus our input, instead of having to click directly on the monaco editor\n    private footerPanelClick = (_event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n        this.props.focusInput();\n    };\n\n    // tslint:disable-next-line: max-func-body-length\n    private renderToolbarPanel() {\n        const variableExplorerTooltip = this.props.variableState.visible\n            ? getLocString('DataScience.collapseVariableExplorerTooltip', 'Hide variables active in jupyter kernel')\n            : getLocString('DataScience.expandVariableExplorerTooltip', 'Show variables active in jupyter kernel');\n\n        return (\n            <div id=\"toolbar-panel\">\n                <div className=\"toolbar-menu-bar\">\n                    <div className=\"toolbar-menu-bar-child\">\n                        <ImageButton\n                            baseTheme={this.props.baseTheme}\n                            onClick={this.props.deleteAllCells}\n                            tooltip={getLocString('DataScience.clearAll', 'Remove all cells')}\n                        >\n                            <Image\n                                baseTheme={this.props.baseTheme}\n                                class=\"image-button-image\"\n                                image={ImageName.Cancel}\n                            />\n                        </ImageButton>\n                        <ImageButton\n                            baseTheme={this.props.baseTheme}\n                            onClick={this.props.redo}\n                            disabled={this.props.redoStack.length === 0}\n                            tooltip={getLocString('DataScience.redo', 'Redo')}\n                        >\n                            <Image baseTheme={this.props.baseTheme} class=\"image-button-image\" image={ImageName.Redo} />\n                        </ImageButton>\n                        <ImageButton\n                            baseTheme={this.props.baseTheme}\n                            onClick={this.props.undo}\n                            disabled={this.props.undoStack.length === 0}\n                            tooltip={getLocString('DataScience.undo', 'Undo')}\n                        >\n                            <Image baseTheme={this.props.baseTheme} class=\"image-button-image\" image={ImageName.Undo} />\n                        </ImageButton>\n                        <ImageButton\n                            baseTheme={this.props.baseTheme}\n                            onClick={this.props.restartKernel}\n                            tooltip={getLocString('DataScience.restartServer', 'Restart Jupyter kernel')}\n                        >\n                            <Image\n                                baseTheme={this.props.baseTheme}\n                                class=\"image-button-image\"\n                                image={ImageName.Restart}\n                            />\n                        </ImageButton>\n                        <ImageButton\n                            baseTheme={this.props.baseTheme}\n                            onClick={this.props.interruptKernel}\n                            tooltip={getLocString('DataScience.interruptKernel', 'Interrupt Jupyter kernel')}\n                        >\n                            <Image\n                                baseTheme={this.props.baseTheme}\n                                class=\"image-button-image\"\n                                image={ImageName.Interrupt}\n                            />\n                        </ImageButton>\n                        <ImageButton\n                            baseTheme={this.props.baseTheme}\n                            onClick={this.props.toggleVariableExplorer}\n                            tooltip={variableExplorerTooltip}\n                        >\n                            <Image\n                                baseTheme={this.props.baseTheme}\n                                class=\"image-button-image\"\n                                image={ImageName.VariableExplorer}\n                            />\n                        </ImageButton>\n                        <ImageButton\n                            baseTheme={this.props.baseTheme}\n                            onClick={this.props.export}\n                            disabled={this.props.cellVMs.length === 0 || this.props.busy}\n                            tooltip={getLocString('DataScience.export', 'Export as Jupyter notebook')}\n                        >\n                            <Image\n                                baseTheme={this.props.baseTheme}\n                                class=\"image-button-image\"\n                                image={ImageName.SaveAs}\n                            />\n                        </ImageButton>\n                        <ImageButton\n                            baseTheme={this.props.baseTheme}\n                            onClick={this.props.exportAs}\n                            disabled={this.props.busy || !this.props.isNotebookTrusted}\n                            className=\"native-button\"\n                            tooltip={getLocString('DataScience.notebookExportAs', 'Export as')}\n                        >\n                            <Image\n                                baseTheme={this.props.baseTheme}\n                                class=\"image-button-image\"\n                                image={ImageName.ExportToPython}\n                            />\n                        </ImageButton>\n                        <ImageButton\n                            baseTheme={this.props.baseTheme}\n                            onClick={this.props.expandAll}\n                            disabled={this.props.cellVMs.length === 0}\n                            tooltip={getLocString('DataScience.expandAll', 'Expand all cell inputs')}\n                        >\n                            <Image\n                                baseTheme={this.props.baseTheme}\n                                class=\"image-button-image\"\n                                image={ImageName.ExpandAll}\n                            />\n                        </ImageButton>\n                        <ImageButton\n                            baseTheme={this.props.baseTheme}\n                            onClick={this.props.collapseAll}\n                            disabled={this.props.cellVMs.length === 0}\n                            tooltip={getLocString('DataScience.collapseAll', 'Collapse all cell inputs')}\n                        >\n                            <Image\n                                baseTheme={this.props.baseTheme}\n                                class=\"image-button-image\"\n                                image={ImageName.CollapseAll}\n                            />\n                        </ImageButton>\n                    </div>\n                    {this.renderKernelSelection()}\n                </div>\n            </div>\n        );\n    }\n\n    private renderKernelSelection() {\n        if (this.props.kernel.serverName === getLocString('DataScience.localJupyterServer', 'local')) {\n            return;\n        }\n\n        return (\n            <JupyterInfo\n                baseTheme={this.props.baseTheme}\n                font={this.props.font}\n                kernel={this.props.kernel}\n                selectServer={this.props.selectServer}\n                selectKernel={this.props.selectKernel}\n                shouldShowTrustMessage={false}\n            />\n        );\n    }\n\n    private renderVariablePanel(baseTheme: string) {\n        if (this.props.variableState.visible) {\n            const variableProps = this.getVariableProps(baseTheme);\n            return <VariablePanel {...variableProps} />;\n        }\n\n        return null;\n    }\n\n    private renderContentPanel(baseTheme: string) {\n        // Skip if the tokenizer isn't finished yet. It needs\n        // to finish loading so our code editors work.\n        if (!this.props.monacoReady && !this.props.testMode) {\n            return null;\n        }\n\n        // Otherwise render our cells.\n        const contentProps = this.getContentProps(baseTheme);\n        return <ContentPanel {...contentProps} ref={this.contentPanelRef} />;\n    }\n\n    private renderFooterPanel(baseTheme: string) {\n        // Skip if the tokenizer isn't finished yet. It needs\n        // to finish loading so our code editors work.\n        if (\n            !this.props.monacoReady ||\n            !this.props.editCellVM ||\n            !this.props.settings ||\n            !this.props.editorOptions ||\n            !this.props.settings.allowInput\n        ) {\n            return null;\n        }\n\n        const executionCount = this.getInputExecutionCount();\n        const editPanelClass = this.props.settings.colorizeInputBox ? 'edit-panel-colorized' : 'edit-panel';\n\n        return (\n            <div className={editPanelClass}>\n                <ErrorBoundary>\n                    <InteractiveCellComponent\n                        role=\"form\"\n                        editorOptions={this.props.editorOptions}\n                        maxTextSize={undefined}\n                        enableScroll={false}\n                        autoFocus={document.hasFocus()}\n                        testMode={this.props.testMode}\n                        cellVM={this.props.editCellVM}\n                        baseTheme={baseTheme}\n                        codeTheme={this.props.codeTheme}\n                        showWatermark={true}\n                        editExecutionCount={executionCount.toString()}\n                        monacoTheme={this.props.monacoTheme}\n                        font={this.props.font}\n                        settings={this.props.settings}\n                        focusPending={this.props.focusPending}\n                        language={this.props.kernel.language}\n                    />\n                </ErrorBoundary>\n            </div>\n        );\n    }\n\n    private getInputExecutionCount = (): number => {\n        return this.props.currentExecutionCount + 1;\n    };\n\n    private getContentProps = (baseTheme: string): IContentPanelProps => {\n        return {\n            baseTheme: baseTheme,\n            cellVMs: this.props.cellVMs,\n            testMode: this.props.testMode,\n            codeTheme: this.props.codeTheme,\n            submittedText: this.props.submittedText,\n            settings: this.props.settings,\n            skipNextScroll: this.props.skipNextScroll ? true : false,\n            editable: false,\n            renderCell: this.renderCell,\n            scrollToBottom: this.scrollDiv,\n            scrollBeyondLastLine: this.props.settings\n                ? this.props.settings.extraSettings.editor.scrollBeyondLastLine\n                : false\n        };\n    };\n    private getVariableProps = (baseTheme: string): IVariablePanelProps => {\n        let toolbarHeight = 0;\n        if (this.mainPanelToolbarRef.current) {\n            toolbarHeight = this.mainPanelToolbarRef.current.offsetHeight;\n        }\n        return {\n            gridHeight: this.props.variableState.gridHeight,\n            containerHeight: this.props.variableState.containerHeight,\n            variables: this.props.variableState.variables,\n            debugging: this.props.debugging,\n            busy: this.props.busy,\n            showDataExplorer: this.props.showDataViewer,\n            skipDefault: this.props.skipDefault,\n            testMode: this.props.testMode,\n            closeVariableExplorer: this.props.toggleVariableExplorer,\n            setVariableExplorerHeight: this.props.setVariableExplorerHeight,\n            baseTheme: baseTheme,\n            pageIn: this.pageInVariableData,\n            fontSize: this.props.font.size,\n            executionCount: this.props.currentExecutionCount,\n            refreshCount: this.props.variableState.refreshCount,\n            offsetHeight: toolbarHeight,\n            supportsDebugging:\n                this.props.settings && this.props.settings.variableOptions\n                    ? this.props.settings.variableOptions.enableDuringDebugger\n                    : false\n        };\n    };\n\n    private pageInVariableData = (startIndex: number, pageSize: number) => {\n        this.props.getVariableData(\n            this.props.currentExecutionCount,\n            this.props.variableState.refreshCount,\n            startIndex,\n            pageSize\n        );\n    };\n\n    private renderCell = (\n        cellVM: ICellViewModel,\n        _index: number,\n        containerRef?: React.RefObject<HTMLDivElement>\n    ): JSX.Element | null => {\n        // Note: MaxOutputSize and enableScrollingForCellOutputs is being ignored on purpose for\n        // the interactive window. See bug: https://github.com/microsoft/vscode-python/issues/11421\n        if (this.props.settings && this.props.editorOptions) {\n            // Disable hover for collapsed code blocks\n            const options = { ...this.props.editorOptions, hover: { enabled: cellVM.inputBlockOpen } };\n            return (\n                <div key={cellVM.cell.id} id={cellVM.cell.id} ref={containerRef}>\n                    <ErrorBoundary>\n                        <InteractiveCellComponent\n                            role=\"listitem\"\n                            editorOptions={options}\n                            maxTextSize={undefined}\n                            enableScroll={false}\n                            autoFocus={false}\n                            testMode={this.props.testMode}\n                            cellVM={cellVM}\n                            baseTheme={this.props.baseTheme}\n                            codeTheme={this.props.codeTheme}\n                            showWatermark={cellVM.cell.id === Identifiers.EditCellId}\n                            editExecutionCount={this.getInputExecutionCount().toString()}\n                            monacoTheme={this.props.monacoTheme}\n                            font={this.props.font}\n                            settings={this.props.settings}\n                            focusPending={this.props.focusPending}\n                            language={this.props.kernel.language}\n                        />\n                    </ErrorBoundary>\n                </div>\n            );\n        } else {\n            return null;\n        }\n    };\n\n    // This handles the scrolling. Its called from the props of contentPanel.\n    // We only scroll when the state indicates we are at the bottom of the interactive window,\n    // otherwise it sometimes scrolls when the user wasn't at the bottom.\n    private scrollDiv = (div: HTMLDivElement) => {\n        if (this.props.isAtBottom) {\n            this.internalScrollCount += 1;\n            // Force auto here as smooth scrolling can be canceled by updates to the window\n            // from elsewhere (and keeping track of these would make this hard to maintain)\n            if (div && div.scrollIntoView) {\n                div.scrollIntoView({ behavior: 'auto', block: 'nearest', inline: 'nearest' });\n            }\n        }\n    };\n\n    private handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\n        if (this.internalScrollCount > 0) {\n            this.internalScrollCount -= 1;\n        } else if (this.contentPanelRef.current) {\n            const isAtBottom = this.props.settings?.alwaysScrollOnNewCell\n                ? true\n                : this.contentPanelRef.current.computeIsAtBottom(e.currentTarget);\n            this.props.scroll(isAtBottom);\n        }\n    };\n\n    private linkClick = (ev: MouseEvent) => {\n        handleLinkClick(ev, this.props.linkClick);\n    };\n}\n\n// Main export, return a redux connected editor\nexport function getConnectedInteractiveEditor() {\n    return connect(mapStateToProps, actionCreators)(InteractivePanel);\n}\n","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n'use strict';\nimport { Identifiers } from '../../../../client/datascience/constants';\nimport {\n    IFinishCell,\n    InteractiveWindowMessages\n} from '../../../../client/datascience/interactive-common/interactiveWindowTypes';\nimport { ICell, IDataScienceExtraSettings } from '../../../../client/datascience/types';\nimport { removeLinesFromFrontAndBack } from '../../../common';\nimport { createCellVM, extractInputText, ICellViewModel, IMainState } from '../../../interactive-common/mainState';\nimport { postActionToExtension } from '../../../interactive-common/redux/helpers';\nimport { Helpers } from '../../../interactive-common/redux/reducers/helpers';\nimport { IAddCellAction, ICellAction } from '../../../interactive-common/redux/reducers/types';\nimport { InteractiveReducerArg } from '../mapping';\n\nexport namespace Creation {\n    function isCellSupported(state: IMainState, cell: ICell): boolean {\n        // Skip message cells in test mode\n        if (state.testMode) {\n            return cell.data.cell_type !== 'messages';\n        }\n        return true;\n    }\n\n    function extractInputBlockText(cellVM: ICellViewModel, settings?: IDataScienceExtraSettings) {\n        // Use the base function first\n        const text = extractInputText(cellVM, settings);\n\n        // Then remove text on the front and back. We only do this for the interactive window\n        return removeLinesFromFrontAndBack(text);\n    }\n\n    export function alterCellVM(\n        cellVM: ICellViewModel,\n        settings?: IDataScienceExtraSettings,\n        visible?: boolean,\n        expanded?: boolean\n    ): ICellViewModel {\n        if (cellVM.cell.data.cell_type === 'code') {\n            // If we are already in the correct state, return back our initial cell vm\n            if (cellVM.inputBlockShow === visible && cellVM.inputBlockOpen === expanded) {\n                return cellVM;\n            }\n\n            const newCellVM = { ...cellVM };\n            if (cellVM.inputBlockShow !== visible) {\n                if (visible) {\n                    // Show the cell, the rest of the function will add on correct collapse state\n                    newCellVM.inputBlockShow = true;\n                } else {\n                    // Hide this cell\n                    newCellVM.inputBlockShow = false;\n                }\n            }\n\n            // No elseif as we want newly visible cells to pick up the correct expand / collapse state\n            if (cellVM.inputBlockOpen !== expanded && cellVM.inputBlockCollapseNeeded && cellVM.inputBlockShow) {\n                let newText = extractInputBlockText(cellVM, settings);\n\n                // While extracting the text, we might eliminate all extra lines\n                if (newText.includes('\\n')) {\n                    if (expanded) {\n                        // Expand the cell\n                        newCellVM.inputBlockOpen = true;\n                        newCellVM.inputBlockText = newText;\n                    } else {\n                        // Collapse the cell\n                        if (newText.length > 0) {\n                            newText = newText.split('\\n', 1)[0];\n                            newText = newText.slice(0, 255); // Slice to limit length, slicing past length is fine\n                            newText = newText.concat('...');\n                        }\n\n                        newCellVM.inputBlockOpen = false;\n                        newCellVM.inputBlockText = newText;\n                    }\n                } else {\n                    // If all lines eliminated, get rid of the collapse bar.\n                    newCellVM.inputBlockCollapseNeeded = false;\n                    newCellVM.inputBlockOpen = true;\n                    newCellVM.inputBlockText = newText;\n                }\n            }\n\n            return newCellVM;\n        }\n\n        return cellVM;\n    }\n\n    export function prepareCellVM(cell: ICell, mainState: IMainState): ICellViewModel {\n        let cellVM: ICellViewModel = createCellVM(cell, mainState.settings, false, mainState.debugging);\n\n        const visible = mainState.settings ? mainState.settings.showCellInputCode : false;\n        const expanded = !mainState.settings?.collapseCellInputCodeByDefault;\n\n        // Set initial cell visibility and collapse\n        cellVM = alterCellVM(cellVM, mainState.settings, visible, expanded);\n        cellVM.hasBeenRun = true;\n\n        return cellVM;\n    }\n\n    export function startCell(arg: InteractiveReducerArg<ICell>): IMainState {\n        if (isCellSupported(arg.prevState, arg.payload.data)) {\n            const result = Helpers.updateOrAdd(arg, prepareCellVM);\n            if (\n                result.cellVMs.length > arg.prevState.cellVMs.length &&\n                arg.payload.data.id !== Identifiers.EditCellId\n            ) {\n                const cellVM = result.cellVMs[result.cellVMs.length - 1];\n\n                // We're adding a new cell here. Tell the intellisense engine we have a new cell\n                postActionToExtension(arg, InteractiveWindowMessages.UpdateModel, {\n                    source: 'user',\n                    kind: 'add',\n                    oldDirty: arg.prevState.dirty,\n                    newDirty: true,\n                    cell: cellVM.cell,\n                    fullText: extractInputText(cellVM, result.settings),\n                    currentText: cellVM.inputBlockText\n                });\n            }\n\n            return result;\n        }\n        return arg.prevState;\n    }\n\n    export function updateCell(arg: InteractiveReducerArg<ICell>): IMainState {\n        if (isCellSupported(arg.prevState, arg.payload.data)) {\n            return Helpers.updateOrAdd(arg, prepareCellVM);\n        }\n        return arg.prevState;\n    }\n\n    export function finishCell(arg: InteractiveReducerArg<IFinishCell>): IMainState {\n        if (isCellSupported(arg.prevState, arg.payload.data.cell)) {\n            return Helpers.updateOrAdd(\n                { ...arg, payload: { ...arg.payload, data: arg.payload.data.cell } },\n                prepareCellVM\n            );\n        }\n        return arg.prevState;\n    }\n\n    export function deleteAllCells(arg: InteractiveReducerArg<IAddCellAction>): IMainState {\n        // Send messages to other side to indicate the deletes\n        postActionToExtension(arg, InteractiveWindowMessages.DeleteAllCells);\n\n        return {\n            ...arg.prevState,\n            cellVMs: [],\n            undoStack: Helpers.pushStack(arg.prevState.undoStack, arg.prevState.cellVMs)\n        };\n    }\n\n    export function deleteCell(arg: InteractiveReducerArg<ICellAction>): IMainState {\n        const index = arg.prevState.cellVMs.findIndex((c) => c.cell.id === arg.payload.data.cellId);\n        if (index >= 0 && arg.payload.data.cellId) {\n            // Send messages to other side to indicate the delete\n            postActionToExtension(arg, InteractiveWindowMessages.UpdateModel, {\n                source: 'user',\n                kind: 'remove',\n                index,\n                oldDirty: arg.prevState.dirty,\n                newDirty: true,\n                cell: arg.prevState.cellVMs[index].cell\n            });\n\n            const newVMs = arg.prevState.cellVMs.filter((_c, i) => i !== index);\n            return {\n                ...arg.prevState,\n                cellVMs: newVMs,\n                undoStack: Helpers.pushStack(arg.prevState.undoStack, arg.prevState.cellVMs)\n            };\n        }\n\n        return arg.prevState;\n    }\n\n    export function unmount(arg: InteractiveReducerArg): IMainState {\n        return {\n            ...arg.prevState,\n            cellVMs: [],\n            undoStack: [],\n            redoStack: [],\n            editCellVM: undefined\n        };\n    }\n\n    export function loaded(arg: InteractiveReducerArg<{ cells: ICell[] }>): IMainState {\n        postActionToExtension(arg, InteractiveWindowMessages.LoadAllCellsComplete, {\n            cells: []\n        });\n        return {\n            ...arg.prevState,\n            loaded: true,\n            busy: false\n        };\n    }\n}\n","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n'use strict';\nimport { Identifiers } from '../../../../client/datascience/constants';\nimport { IScrollToCell } from '../../../../client/datascience/interactive-common/interactiveWindowTypes';\nimport { CssMessages } from '../../../../client/datascience/messages';\nimport { IDataScienceExtraSettings } from '../../../../client/datascience/types';\nimport { IMainState } from '../../../interactive-common/mainState';\nimport { postActionToExtension } from '../../../interactive-common/redux/helpers';\nimport { Helpers } from '../../../interactive-common/redux/reducers/helpers';\nimport { ICellAction, IScrollAction } from '../../../interactive-common/redux/reducers/types';\nimport { computeEditorOptions } from '../../../react-common/settingsReactSide';\nimport { InteractiveReducerArg } from '../mapping';\nimport { Creation } from './creation';\n\nexport namespace Effects {\n    export function expandAll(arg: InteractiveReducerArg): IMainState {\n        if (arg.prevState.settings?.showCellInputCode) {\n            const newVMs = arg.prevState.cellVMs.map((c) =>\n                Creation.alterCellVM({ ...c }, arg.prevState.settings, true, true)\n            );\n            return {\n                ...arg.prevState,\n                cellVMs: newVMs\n            };\n        }\n        return arg.prevState;\n    }\n\n    export function collapseAll(arg: InteractiveReducerArg): IMainState {\n        if (arg.prevState.settings?.showCellInputCode) {\n            const newVMs = arg.prevState.cellVMs.map((c) =>\n                Creation.alterCellVM({ ...c }, arg.prevState.settings, true, false)\n            );\n            return {\n                ...arg.prevState,\n                cellVMs: newVMs\n            };\n        }\n        return arg.prevState;\n    }\n\n    export function toggleInputBlock(arg: InteractiveReducerArg<ICellAction>): IMainState {\n        if (arg.payload.data.cellId) {\n            const newVMs = [...arg.prevState.cellVMs];\n            const index = arg.prevState.cellVMs.findIndex((c) => c.cell.id === arg.payload.data.cellId);\n            const oldVM = arg.prevState.cellVMs[index];\n            newVMs[index] = Creation.alterCellVM({ ...oldVM }, arg.prevState.settings, true, !oldVM.inputBlockOpen);\n            return {\n                ...arg.prevState,\n                cellVMs: newVMs\n            };\n        }\n        return arg.prevState;\n    }\n\n    export function updateSettings(arg: InteractiveReducerArg<string>): IMainState {\n        // String arg should be the IDataScienceExtraSettings\n        const newSettingsJSON = JSON.parse(arg.payload.data);\n        const newSettings = <IDataScienceExtraSettings>newSettingsJSON;\n        const newEditorOptions = computeEditorOptions(newSettings);\n        const newFontFamily = newSettings.extraSettings\n            ? newSettings.extraSettings.editor.fontFamily\n            : arg.prevState.font.family;\n        const newFontSize = newSettings.extraSettings\n            ? newSettings.extraSettings.editor.fontSize\n            : arg.prevState.font.size;\n\n        // Ask for new theme data if necessary\n        if (\n            newSettings &&\n            newSettings.extraSettings &&\n            newSettings.extraSettings.theme !== arg.prevState.vscodeThemeName\n        ) {\n            const knownDark = Helpers.computeKnownDark(newSettings);\n            // User changed the current theme. Rerender\n            postActionToExtension(arg, CssMessages.GetCssRequest, { isDark: knownDark });\n            postActionToExtension(arg, CssMessages.GetMonacoThemeRequest, { isDark: knownDark });\n        }\n\n        // Update our input cell state if the user changed this setting\n        let newVMs = arg.prevState.cellVMs;\n        if (newSettings.showCellInputCode !== arg.prevState.settings?.showCellInputCode) {\n            newVMs = arg.prevState.cellVMs.map((c) =>\n                Creation.alterCellVM(\n                    c,\n                    newSettings,\n                    newSettings.showCellInputCode,\n                    !newSettings.collapseCellInputCodeByDefault\n                )\n            );\n        }\n\n        return {\n            ...arg.prevState,\n            cellVMs: newVMs,\n            settings: newSettings,\n            editorOptions: newEditorOptions,\n            font: {\n                size: newFontSize,\n                family: newFontFamily\n            }\n        };\n    }\n\n    export function scrollToCell(arg: InteractiveReducerArg<IScrollToCell>): IMainState {\n        // Up the scroll count on the necessary cell\n        const index = arg.prevState.cellVMs.findIndex((c) => c.cell.id === arg.payload.data.id);\n        if (index >= 0) {\n            const newVMs = [...arg.prevState.cellVMs];\n\n            // Scroll one cell and unscroll another.\n            newVMs[index] = { ...newVMs[index], scrollCount: newVMs[index].scrollCount + 1 };\n            return {\n                ...arg.prevState,\n                cellVMs: newVMs\n            };\n        }\n\n        return arg.prevState;\n    }\n\n    export function scrolled(arg: InteractiveReducerArg<IScrollAction>): IMainState {\n        return {\n            ...arg.prevState,\n            isAtBottom: arg.payload.data.isAtBottom\n        };\n    }\n\n    export function clickCell(arg: InteractiveReducerArg<ICellAction>): IMainState {\n        if (\n            arg.payload.data.cellId === Identifiers.EditCellId &&\n            arg.prevState.editCellVM &&\n            !arg.prevState.editCellVM.focused\n        ) {\n            return {\n                ...arg.prevState,\n                editCellVM: {\n                    ...arg.prevState.editCellVM,\n                    focused: true\n                }\n            };\n        } else if (arg.prevState.editCellVM) {\n            return {\n                ...arg.prevState,\n                editCellVM: {\n                    ...arg.prevState.editCellVM,\n                    focused: false\n                }\n            };\n        }\n\n        return arg.prevState;\n    }\n\n    export function unfocusCell(arg: InteractiveReducerArg<ICellAction>): IMainState {\n        if (\n            arg.payload.data.cellId === Identifiers.EditCellId &&\n            arg.prevState.editCellVM &&\n            arg.prevState.editCellVM.focused\n        ) {\n            return {\n                ...arg.prevState,\n                editCellVM: {\n                    ...arg.prevState.editCellVM,\n                    focused: false\n                }\n            };\n        }\n\n        return arg.prevState;\n    }\n}\n","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n'use strict';\n// tslint:disable-next-line: no-require-imports no-var-requires\nconst cloneDeep = require('lodash/cloneDeep');\nimport * as uuid from 'uuid/v4';\n\nimport { CellMatcher } from '../../../../client/datascience/cellMatcher';\nimport { InteractiveWindowMessages } from '../../../../client/datascience/interactive-common/interactiveWindowTypes';\nimport { CellState } from '../../../../client/datascience/types';\nimport { generateMarkdownFromCodeLines } from '../../../common';\nimport { createCellFrom } from '../../../common/cellFactory';\nimport { createCellVM, IMainState } from '../../../interactive-common/mainState';\nimport { postActionToExtension } from '../../../interactive-common/redux/helpers';\nimport { Helpers } from '../../../interactive-common/redux/reducers/helpers';\nimport { ICodeAction } from '../../../interactive-common/redux/reducers/types';\nimport { InteractiveReducerArg } from '../mapping';\nimport { Creation } from './creation';\n\nexport namespace Execution {\n    export function undo(arg: InteractiveReducerArg): IMainState {\n        if (arg.prevState.undoStack.length > 0) {\n            // Pop one off of our undo stack and update our redo\n            const cells = arg.prevState.undoStack[arg.prevState.undoStack.length - 1];\n            const undoStack = arg.prevState.undoStack.slice(0, arg.prevState.undoStack.length - 1);\n            const redoStack = Helpers.pushStack(arg.prevState.redoStack, arg.prevState.cellVMs);\n            postActionToExtension(arg, InteractiveWindowMessages.Undo);\n            return {\n                ...arg.prevState,\n                cellVMs: cells,\n                undoStack: undoStack,\n                redoStack: redoStack,\n                skipNextScroll: true\n            };\n        }\n\n        return arg.prevState;\n    }\n\n    export function redo(arg: InteractiveReducerArg): IMainState {\n        if (arg.prevState.redoStack.length > 0) {\n            // Pop one off of our redo stack and update our undo\n            const cells = arg.prevState.redoStack[arg.prevState.redoStack.length - 1];\n            const redoStack = arg.prevState.redoStack.slice(0, arg.prevState.redoStack.length - 1);\n            const undoStack = Helpers.pushStack(arg.prevState.undoStack, arg.prevState.cellVMs);\n            postActionToExtension(arg, InteractiveWindowMessages.Redo);\n            return {\n                ...arg.prevState,\n                cellVMs: cells,\n                undoStack: undoStack,\n                redoStack: redoStack,\n                skipNextScroll: true\n            };\n        }\n\n        return arg.prevState;\n    }\n\n    export function startDebugging(arg: InteractiveReducerArg): IMainState {\n        return {\n            ...arg.prevState,\n            debugging: true\n        };\n    }\n\n    export function stopDebugging(arg: InteractiveReducerArg): IMainState {\n        return {\n            ...arg.prevState,\n            debugging: false\n        };\n    }\n\n    export function submitInput(arg: InteractiveReducerArg<ICodeAction>): IMainState {\n        // noop if the submitted code is just a cell marker\n        const matcher = new CellMatcher(arg.prevState.settings);\n        if (matcher.stripFirstMarker(arg.payload.data.code).length > 0 && arg.prevState.editCellVM) {\n            // This should be from the edit cell VM. Copy it and change the cell id\n            let newCell = cloneDeep(arg.prevState.editCellVM);\n\n            // Change this editable cell to not editable.\n            newCell.cell.state = CellState.executing;\n            newCell.cell.data.source = arg.payload.data.code;\n\n            // Change type to markdown if necessary\n            const split = arg.payload.data.code.splitLines({ trim: false });\n            const firstLine = split[0];\n            if (matcher.isMarkdown(firstLine)) {\n                newCell.cell.data = createCellFrom(newCell.cell.data, 'markdown');\n                newCell.cell.data.source = generateMarkdownFromCodeLines(split);\n                newCell.cell.state = CellState.finished;\n            } else if (newCell.cell.data.cell_type === 'markdown') {\n                newCell.cell.state = CellState.finished;\n            }\n\n            // Update input controls (always show expanded since we just edited it.)\n            newCell = createCellVM(newCell.cell, arg.prevState.settings, false, false);\n            const collapseInputs = arg.prevState.settings\n                ? arg.prevState.settings.collapseCellInputCodeByDefault\n                : false;\n            newCell = Creation.alterCellVM(newCell, arg.prevState.settings, true, !collapseInputs);\n            newCell.useQuickEdit = false;\n\n            // Generate a new id\n            newCell.cell.id = uuid();\n\n            // Indicate this is direct input so that we don't hide it if the user has\n            // hide all inputs turned on.\n            newCell.directInput = true;\n\n            // Send a message to execute this code if necessary.\n            if (newCell.cell.state !== CellState.finished) {\n                postActionToExtension(arg, InteractiveWindowMessages.SubmitNewCell, {\n                    code: arg.payload.data.code,\n                    id: newCell.cell.id\n                });\n            }\n\n            // Stick in a new cell at the bottom that's editable and update our state\n            // so that the last cell becomes busy\n            return {\n                ...arg.prevState,\n                cellVMs: [...arg.prevState.cellVMs, newCell],\n                undoStack: Helpers.pushStack(arg.prevState.undoStack, arg.prevState.cellVMs),\n                skipNextScroll: false,\n                submittedText: true\n            };\n        }\n        return arg.prevState;\n    }\n}\n","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n'use strict';\nimport { InteractiveWindowMessages } from '../../../../client/datascience/interactive-common/interactiveWindowTypes';\nimport { CssMessages, SharedMessages } from '../../../../client/datascience/messages';\nimport { CommonEffects } from '../../../interactive-common/redux/reducers/commonEffects';\nimport { Kernel } from '../../../interactive-common/redux/reducers/kernel';\nimport { Transfer } from '../../../interactive-common/redux/reducers/transfer';\nimport { CommonActionType } from '../../../interactive-common/redux/reducers/types';\nimport { IInteractiveActionMapping } from '../mapping';\nimport { Creation } from './creation';\nimport { Effects } from './effects';\nimport { Execution } from './execution';\n\n// The list of reducers. 1 per message/action.\nexport const reducerMap: Partial<IInteractiveActionMapping> = {\n    // State updates\n    [CommonActionType.RESTART_KERNEL]: Kernel.restartKernel,\n    [CommonActionType.INTERRUPT_KERNEL]: Kernel.interruptKernel,\n    [InteractiveWindowMessages.SelectKernel]: Kernel.selectKernel,\n    [CommonActionType.SELECT_SERVER]: Kernel.selectJupyterURI,\n    [CommonActionType.OPEN_SETTINGS]: CommonEffects.openSettings,\n    [CommonActionType.EXPORT]: Transfer.exportCells,\n    [CommonActionType.EXPORT_NOTEBOOK_AS]: Transfer.showExportAsMenu,\n    [CommonActionType.SAVE]: Transfer.save,\n    [CommonActionType.SHOW_DATA_VIEWER]: Transfer.showDataViewer,\n    [CommonActionType.DELETE_CELL]: Creation.deleteCell,\n    [InteractiveWindowMessages.ShowPlot]: Transfer.showPlot,\n    [CommonActionType.LINK_CLICK]: Transfer.linkClick,\n    [CommonActionType.GOTO_CELL]: Transfer.gotoCell,\n    [CommonActionType.TOGGLE_INPUT_BLOCK]: Effects.toggleInputBlock,\n    [CommonActionType.COPY_CELL_CODE]: Transfer.copyCellCode,\n    [CommonActionType.GATHER_CELL]: Transfer.gather,\n    [CommonActionType.GATHER_CELL_TO_SCRIPT]: Transfer.gatherToScript,\n    [CommonActionType.EDIT_CELL]: Transfer.editCell,\n    [CommonActionType.SUBMIT_INPUT]: Execution.submitInput,\n    [InteractiveWindowMessages.ExpandAll]: Effects.expandAll,\n    [CommonActionType.EDITOR_LOADED]: Transfer.started,\n    [InteractiveWindowMessages.LoadAllCells]: Creation.loaded,\n    [CommonActionType.SCROLL]: Effects.scrolled,\n    [CommonActionType.CLICK_CELL]: Effects.clickCell,\n    [CommonActionType.UNFOCUS_CELL]: Effects.unfocusCell,\n    [CommonActionType.UNMOUNT]: Creation.unmount,\n    [CommonActionType.FOCUS_INPUT]: CommonEffects.focusInput,\n    [CommonActionType.LOAD_IPYWIDGET_CLASS_SUCCESS]: CommonEffects.handleLoadIPyWidgetClassSuccess,\n    [CommonActionType.LOAD_IPYWIDGET_CLASS_FAILURE]: CommonEffects.handleLoadIPyWidgetClassFailure,\n    [CommonActionType.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED]: CommonEffects.notifyAboutUnsupportedWidgetVersions,\n    [CommonActionType.IPYWIDGET_RENDER_FAILURE]: CommonEffects.handleIPyWidgetRenderFailure,\n\n    // Messages from the webview (some are ignored)\n    [InteractiveWindowMessages.Undo]: Execution.undo,\n    [InteractiveWindowMessages.Redo]: Execution.redo,\n    [InteractiveWindowMessages.StartCell]: Creation.startCell,\n    [InteractiveWindowMessages.FinishCell]: Creation.finishCell,\n    [InteractiveWindowMessages.UpdateCellWithExecutionResults]: Creation.updateCell,\n    [InteractiveWindowMessages.Activate]: CommonEffects.activate,\n    [InteractiveWindowMessages.RestartKernel]: Kernel.handleRestarted,\n    [CssMessages.GetCssResponse]: CommonEffects.handleCss,\n    [InteractiveWindowMessages.MonacoReady]: CommonEffects.monacoReady,\n    [CssMessages.GetMonacoThemeResponse]: CommonEffects.monacoThemeChange,\n    [InteractiveWindowMessages.GetAllCells]: Transfer.getAllCells,\n    [InteractiveWindowMessages.ExpandAll]: Effects.expandAll,\n    [InteractiveWindowMessages.CollapseAll]: Effects.collapseAll,\n    [InteractiveWindowMessages.DeleteAllCells]: Creation.deleteAllCells,\n    [InteractiveWindowMessages.StartProgress]: CommonEffects.startProgress,\n    [InteractiveWindowMessages.StopProgress]: CommonEffects.stopProgress,\n    [SharedMessages.UpdateSettings]: Effects.updateSettings,\n    [InteractiveWindowMessages.StartDebugging]: Execution.startDebugging,\n    [InteractiveWindowMessages.StopDebugging]: Execution.stopDebugging,\n    [InteractiveWindowMessages.ScrollToCell]: Effects.scrollToCell,\n    [InteractiveWindowMessages.UpdateKernel]: Kernel.updateStatus,\n    [SharedMessages.LocInit]: CommonEffects.handleLocInit,\n    [InteractiveWindowMessages.UpdateDisplayData]: CommonEffects.handleUpdateDisplayData,\n    [InteractiveWindowMessages.HasCell]: Transfer.hasCell,\n    [InteractiveWindowMessages.Gathering]: Transfer.gathering\n};\n","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n'use strict';\n\n// This must be on top, do not change. Required by webpack.\nimport '../common/main';\n// This must be on top, do not change. Required by webpack.\n\n// tslint:disable-next-line: ordered-imports\nimport '../common/index.css';\n\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport { WidgetManagerComponent } from '../ipywidgets/container';\nimport { IVsCodeApi, PostOffice } from '../react-common/postOffice';\nimport { detectBaseTheme } from '../react-common/themeDetector';\nimport { getConnectedInteractiveEditor } from './interactivePanel';\nimport { createStore } from './redux/store';\n\n// This special function talks to vscode from a web panel\nexport declare function acquireVsCodeApi(): IVsCodeApi;\nconst baseTheme = detectBaseTheme();\n// tslint:disable-next-line: no-any\nconst testMode = (window as any).inTestMode;\n// tslint:disable-next-line: no-typeof-undefined\nconst skipDefault = testMode ? false : typeof acquireVsCodeApi !== 'undefined';\n\n// Create the redux store\nconst postOffice = new PostOffice();\nconst store = createStore(skipDefault, baseTheme, testMode, postOffice);\n\n// Wire up a connected react control for our InteractiveEditor\nconst ConnectedInteractiveEditor = getConnectedInteractiveEditor();\n\n// Stick them all together\n// tslint:disable:no-typeof-undefined\nReactDOM.render(\n    <Provider store={store}>\n        <ConnectedInteractiveEditor />\n        <WidgetManagerComponent postOffice={postOffice} widgetContainerId={'rootWidget'} store={store} />\n    </Provider>,\n    document.getElementById('root') as HTMLElement\n);\n","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n'use strict';\n\nimport * as ReduxCommon from '../../interactive-common/redux/store';\nimport { PostOffice } from '../../react-common/postOffice';\nimport { reducerMap } from './reducers';\n\n// This special version uses the reducer map from the IInteractiveWindowMapping\nexport function createStore(skipDefault: boolean, baseTheme: string, testMode: boolean, postOffice: PostOffice) {\n    return ReduxCommon.createStore(skipDefault, baseTheme, testMode, false, false, reducerMap, postOffice);\n}\n","\nvar content = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/less-loader/dist/cjs.js!./interactivePanel.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/less-loader/dist/cjs.js!./interactivePanel.less\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/less-loader/dist/cjs.js!./interactivePanel.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","module.exports = log4js;"],"sourceRoot":""}